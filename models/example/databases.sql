{{ config(
            materialized='table',
                post_hook={
                    "sql": "CREATE TEMPORARY TABLE SKU_MAPPING AS select * from (select * ,row_number() over (partition by MARKETPLACE_SKU order by 1) frw from ( select SHOPIFY_SKU MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'SHOPIFY_ZOUKBAGS\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by SHOPIFY_SKU order by 1) rw from maplemonk.zouk_gs_sku_master where SHOPIFY_SKU is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(SHOPIFY_SKU) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) UNION ALL select AMAZON_ASIN MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'AMAZON\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by AMAZON_ASIN order by 1) rw from maplemonk.zouk_gs_sku_master where AMAZON_ASIN is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(AMAZON_ASIN) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) UNION ALL select FLIPKART_FSN MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'FLIPKART\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by FLIPKART_FSN order by 1) rw from maplemonk.zouk_gs_sku_master where FLIPKART_FSN is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(FLIPKART_FSN) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) UNION ALL select MYNTRA MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'MYNTRA\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by MYNTRA order by 1) rw from maplemonk.zouk_gs_sku_master where MYNTRA is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(MYNTRA) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) UNION ALL select NYKAA MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'NYKAA\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by NYKAA order by 1) rw from maplemonk.zouk_gs_sku_master where NYKAA is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(NYKAA) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) UNION ALL select NYKAA_FASHIN MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'NYKAA_FASHION\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by NYKAA_FASHIN order by 1) rw from maplemonk.zouk_gs_sku_master where NYKAA_FASHIN is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(NYKAA_FASHIN) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) UNION ALL select AJIO MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'AJIO\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by AJIO order by 1) rw from maplemonk.zouk_gs_sku_master where AJIO is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(AJIO) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) UNION ALL select TATACLIQ MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'TATACLIQ\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by TATACLIQ order by 1) rw from maplemonk.zouk_gs_sku_master where tatacliq is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(TATACLIQ) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) UNION ALL select SWIGGY MARKETPLACE_SKU ,upper(PRODUCT_TITLE) NAME ,\'SWIGGY\' MARKETPLACE ,upper(category) CATEGORY ,UPPER(TYPE) SUB_CATEGORY ,CATEGORY_CODE ,upper(COLLECTION) COLLECTION ,UPPER(PRINT) PRINT ,commonsku from (select * , row_number() over (partition by SWIGGY order by 1) rw from maplemonk.zouk_gs_sku_master where swiggy is not null ) where rw = 1 and (upper(commonsku) not in (\'#N/A\', \'0\', \'NA\', \'N/A\') or upper(SWIGGY) not in (\'#N/A\', \'0\', \'NA\', \'N/A\')) ) ) where frw = 1; CREATE OR REPLACE TABLE maplemonk.FINAL_SKU_MASTER AS select sm.* ,cm.MRP ,cm.Product_Bucket ,cm.Product_Type ,cm.BAU_Offline ,cm.BAU_Online ,cm.TAX_RATE ,cm.Size ,cm.Length ,cm.Weight ,cm.Width ,cm.Volume ,cm.hsn_code from SKU_MAPPING sm left join (select * from (select categor_code category_code ,category ,PRODUCT_TYPE ,COLLECTION ,SAFE_CAST(MRP AS FLOAT64) MRP ,SAFE_CAST(BAU_Online AS FLOAT64) BAU_Online ,SAFE_CAST(BAU_Offline AS FLOAT64) BAU_Offline ,HSN_code ,safe_Cast(replace(SAFE_CAST(Tax_rate AS STRING),\'%\',\'\') as float64)/100 TAX_RATE ,SAFE_CAST(Size AS STRING) Size ,SAFE_CAST(Weight AS FLOAT64) Weight ,SAFE_CAST(Length AS FLOAT64) Length ,SAFE_CAST(Height AS FLOAT64) Height ,SAFE_CAST(Width AS FLOAT64) Width ,SAFE_CAST(Volume AS FLOAT64) Volume ,SAFE_CAST(Product_Bucket AS STRING) Product_Bucket ,row_number () over (partition by categor_code order by 1) rw from maplemonk.zouk_gs_category_master ) where rw=1 ) cm ON lower(SM.category_code) = lower(cm.category_code);",
                    "transaction": true
                }
            ) }}
            with sample_data as (

                select * from maplemonk.INFORMATION_SCHEMA.TABLES
            ),
            
            final as (
                select * from sample_data
            )
            select * from final
            