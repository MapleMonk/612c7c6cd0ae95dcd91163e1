{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "CREATE OR REPLACE TABLE RPSG_DB.MAPLEMONK.TARGETS_VS_ACHIEVED_THREE60YOU AS WITH SESSIONS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 1 as sort, \'Sessions\' AS METRIC_TYPE, SUM(TRAFFIC) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_SESSIONS),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%session%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%session%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%session%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%session%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), addtocarts AS ( SELECT DATE, MARKETPLACE, CHANNEL, 1.98 as sort, \'AddToCarts\' AS METRIC_TYPE, SUM(addtocarts) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_SESSIONS),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%add to carts%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%add to carts%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%add to carts%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%add to carts%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), CheckOuts AS ( SELECT DATE, MARKETPLACE, CHANNEL, 1.99 as sort, \'CheckOuts\' AS METRIC_TYPE, SUM(checkouts) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_SESSIONS),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%checkouts%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%checkouts%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%checkouts%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%checkouts%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), ORDERS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 3 as sort, \'Booked Orders\' AS METRIC_TYPE, SUM(total_orders) AS ACTUAL, SUM(ifnull(overall_orders,0)) AS OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked order%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked order%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked order%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked order%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), BOOKED_REVENUE AS ( SELECT DATE, MARKETPLACE, CHANNEL, 4 as sort, \'Booked Revenue\' AS METRIC_TYPE, SUM(total_sales) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked revenue\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked revenue\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked revenue\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked revenue\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), BOOKED_REVENUE_After_tax AS ( SELECT DATE, MARKETPLACE, CHANNEL, 4.6 as sort, \'Booked Revenue After Tax\' AS METRIC_TYPE, SUM(ifnull(total_sales_ex_tax,0)) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked revenue after tax%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked revenue after tax%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked revenue after tax%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked revenue after tax%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), SPENDS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 9 as sort, \'Spends\' AS METRIC_TYPE, SUM(marketing_spend) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%spends%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%spends%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%spends%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%spends%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), DELIVERED_REVENUE AS ( SELECT DATE, MARKETPLACE, CHANNEL, 8 as sort, \'Net Delivered Revenue\' AS METRIC_TYPE, SUM(realised_revenue) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%net delivered revenue%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%net delivered revenue%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%net delivered revenue%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%net delivered revenue%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), RTO_VALUE AS ( SELECT DATE, MARKETPLACE, CHANNEL, 6 as sort, \'RTO Value\' AS METRIC_TYPE, sum(ifnull(return_value,0)) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%rto value%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%rto value%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%rto value%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%rto value%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), CONVERSION_RATE AS ( SELECT DATE, MARKETPLACE, CHANNEL, 3.1 as sort, \'Conversion Rate\' AS METRIC_TYPE, sum(ifnull(total_orders,0)) ACTUAL, null as OV_ACTUAL, sum(ifnull(traffic,0)) as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), AOV AS ( SELECT DATE, MARKETPLACE, CHANNEL, 5 as sort, \'AOV\' METRIC_TYPE, sum(ifnull(total_sales_ex_tax,0)) AS ACTUAL, null as OV_ACTUAL, sum(ifnull(total_orders,0)) as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%aov w/o gst%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%aov w/o gst%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%aov w/o gst%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%aov w/o gst%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), BOOKED_ROAS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 10 as sort, \'Booked ROAS\' AS METRIC_TYPE, ifnull(sum(total_sales_ex_tax),0) ACTUAL, null as OV_ACTUAL, ifnull(sum(marketing_spend),0) AS ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked roas - tax%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked roas - tax%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked roas - tax%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked roas - tax%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), DELIVERED_ROAS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 11 as sort, \'Net Delivered ROAS\' AS METRIC_TYPE, ifnull(sum(realised_revenue),0) ACTUAL, null as OV_ACTUAL, ifnull(sum(marketing_spend),0) AS ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%net delivered roas%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%net delivered roas%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%net delivered roas%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%net delivered roas%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), RTO_PERCENTAGE AS ( SELECT DATE, MARKETPLACE, CHANNEL, 7 as sort, \'RTO %\' AS METRIC_TYPE, ifnull(sum(return_value),0) ACTUAL, null as OV_ACTUAL, ifnull(sum(invoice_amount_excl_tax),0) AS ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%rto%\' and LOWER(METRIC) not LIKE \'%rto value%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%rto%\' and LOWER(METRIC) not LIKE \'%rto value%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%rto%\' and LOWER(METRIC) not LIKE \'%rto value%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%rto%\' and LOWER(METRIC) not LIKE \'%rto value%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), TOTAL_CONSULTATIONS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 1.4 as sort, \'Consultations Completed\' AS METRIC_TYPE, SUM(ifnull(consultation_completed,0)) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_SESSIONS),count(*) over(partition by last_day(date)))Target, 0 as Target_three60, 0 as Target_three60plus, div0(sum(tr3.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%consultations_complete%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'consultations_complete%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), CONSULTATIONS_CONFIRMED AS ( SELECT DATE, MARKETPLACE, CHANNEL, 1.2 as sort, \'Consultations Booked\' AS METRIC_TYPE, SUM(ifnull(consultation_confirmed,0)) AS ACTUAL, null as OV_ACTUAL, null as ACTUAL_D, div0(sum(tr.T_SESSIONS),count(*) over(partition by last_day(date)))Target, 0 as Target_three60, 0 as Target_three60plus, div0(sum(tr3.T_SESSIONS),count(1) over(partition by last_day(date),lower(marketplace)))Target_consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%consultations_booked%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(REPLACE(TARGET,\',\',\'\'))T_SESSIONS FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%consultations_booked%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), BOOKING_CONVERSIONS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 1.1 as sort, \'Booking Conversion %\' AS METRIC_TYPE, sum(ifnull(consultation_confirmed,0)) ACTUAL, null as OV_ACTUAL, sum(ifnull(traffic,0)) as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked conversion%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), confirmed_CONVERSIONS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 1.3 as sort, \'Booked 2 Confirmed Consultation %\' AS METRIC_TYPE, sum(ifnull(consultation_completed,0)) ACTUAL, null as OV_ACTUAL, sum(ifnull(consultation_confirmed,0)) as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%booked 2 consultations completed%\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ), consultations_Orders_CONVERSIONS AS ( SELECT DATE, MARKETPLACE, CHANNEL, 1.6 as sort, \'Consultation 2 Orders %\' AS METRIC_TYPE, sum(ifnull(overall_orders,0)) ACTUAL, null as OV_ACTUAL, sum(ifnull(consultation_completed,0)) as ACTUAL_D, div0(sum(tr.T_metric),count(*) over(partition by last_day(date)))Target, div0(sum(tr1.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60, div0(sum(tr2.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60plus, div0(sum(tr3.T_metric),count(1) over(partition by last_day(date),lower(marketplace)))Target_three60consultations FROM RPSG_DB.MAPLEMONK.SALES_COST_SOURCE_THREE60YOU scs left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%overall%\' GROUP BY 1,2 )tr on last_day(scs.date) = last_day(tr.month::date) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%three60%\' and lower(brand) not like \'%three60plus%\' GROUP BY 1,2 )tr1 on last_day(scs.date) = last_day(tr1.month::date) and lower(scs.marketplace) = lower(tr1.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%conversion rate%\' and lower(brand) like \'%three60plus%\' GROUP BY 1,2 )tr2 on last_day(scs.date) = last_day(tr2.month::date) and lower(scs.marketplace) = lower(tr2.brand) left join ( SELECT MONTH,BRAND,SUM(replace(REPLACE(TARGET,\',\',\'\'),\'%\',\'\'))/100 T_metric FROM RPSG_DB.MAPLEMONK.THREE60_TARGETS WHERE LOWER(METRIC) LIKE \'%consultations 2 order %\' and lower(brand) like \'%consultation%\' GROUP BY 1,2 )tr3 on last_day(scs.date) = last_day(tr3.month::date) and lower(scs.marketplace) = lower(tr3.brand) GROUP BY 1,2,3 ORDER BY 1 DESC ) SELECT * FROM SESSIONS UNION ALL SELECT * FROM ORDERS UNION ALL SELECT * FROM BOOKED_REVENUE UNION ALL SELECT * FROM SPENDS UNION ALL SELECT * FROM DELIVERED_REVENUE UNION ALL SELECT * FROM RTO_VALUE UNION ALL SELECT * FROM CONVERSION_RATE UNION ALL SELECT * FROM AOV UNION ALL SELECT * FROM BOOKED_ROAS UNION ALL SELECT * FROM DELIVERED_ROAS UNION ALL SELECT * FROM RTO_PERCENTAGE UNION ALL SELECT * FROM TOTAL_CONSULTATIONS UNION ALL SELECT * FROM CONSULTATIONS_CONFIRMED UNION ALL Select * from BOOKED_REVENUE_After_tax UNION ALL Select * from CheckOuts UNION ALL select * from addtocarts union all SELECT * FROM BOOKING_CONVERSIONS union all select * from confirmed_CONVERSIONS UNION ALL SELECT * FROM consultations_Orders_CONVERSIONS",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from RPSG_DB.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        