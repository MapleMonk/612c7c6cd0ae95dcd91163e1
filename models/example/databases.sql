{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "CREATE OR REPLACE TABLE VAHDAM_DB.MAPLEMONK.ITALY_DSR AS WITH CTE AS (SELECT FI.ORDER_TIMESTAMP::date AS DATE, UPPER(DAYNAME(FI.ORDER_TIMESTAMP::DATE)) AS Day, SUM(CASE WHEN FI.shop_name=\'Shopify_Italy\' THEN FI.Net_Sales_INR END) AS Shopify_Italy_Sales_INR, SUM(CASE WHEN FI.shop_name=\'Shopify_Italy\' THEN FI.Net_Sales END) AS Shopify_Italy_Sales_EUR, SUM(CASE WHEN FI.shop_name=\'Amazon_IT\' THEN FI.Net_Sales_INR END) AS Amazon_Italy_Sales_INR, SUM(CASE WHEN FI.shop_name=\'Amazon_IT\' THEN FI.Net_Sales END) AS Amazon_Italy_Sales_EUR FROM Vahdam_db.maplemonk.FACT_ITEMS FI WHERE FI.is_refund=0 GROUP BY FI.ORDER_TIMESTAMP::date ORDER BY FI.ORDER_TIMESTAMP::date DESC) SELECT CTE.*, AZ.AMAZON_ADS_IT_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_IT_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_IT_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_IT_SPEND_SPONSORED_BRANDS, FG.FACEBOOK_ADS_ITALY_SPEND FROM CTE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_IT\' THEN SPEND END) AS AMAZON_ADS_IT_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_IT\' THEN SPEND END) AS AMAZON_ADS_IT_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_IT\' THEN SPEND END) AS AMAZON_ADS_IT_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_IT\' THEN SPEND END) AS AMAZON_ADS_IT_SPEND_SPONSORED_BRANDS FROM Vahdam_db.maplemonk.AMAZONADS_EU_MARKETING GROUP BY DATE) AZ ON CTE.DATE=AZ.DATE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CHANNEL=\'Facebook Ads\' THEN SPEND END) AS FACEBOOK_ADS_ITALY_SPEND FROM Vahdam_db.maplemonk.facebook_italy_consolidated GROUP BY DATE) FG ON CTE.DATE=FG.DATE ORDER BY CTE.DATE DESC; CREATE OR REPLACE TABLE VAHDAM_DB.MAPLEMONK.Germany_DSR AS WITH CTE AS (SELECT FI.ORDER_TIMESTAMP::date AS DATE, UPPER(DAYNAME(FI.ORDER_TIMESTAMP::DATE)) AS Day, SUM(CASE WHEN FI.shop_name=\'Shopify_Germany\' THEN FI.Net_Sales_INR END) AS Shopify_Germany_Sales_INR, SUM(CASE WHEN FI.shop_name=\'Shopify_Germany\' THEN FI.Net_Sales END) AS Shopify_Germany_Sales_EUR, SUM(CASE WHEN FI.shop_name=\'Amazon_DE\' THEN FI.Net_Sales_INR END) AS Amazon_Germany_Sales_INR, SUM(CASE WHEN FI.shop_name=\'Amazon_DE\' THEN FI.Net_Sales END) AS Amazon_Germany_Sales_EUR FROM Vahdam_db.maplemonk.FACT_ITEMS FI WHERE FI.is_refund=0 GROUP BY FI.ORDER_TIMESTAMP::date ORDER BY FI.ORDER_TIMESTAMP::date DESC) SELECT CTE.*, AZ.AMAZON_ADS_DE_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_DE_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_DE_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_DE_SPEND_SPONSORED_BRANDS, FG.GOOGLE_ADS_GERMANY_SPEND, FG.FACEBOOK_ADS_GERMANY_SPEND FROM CTE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_DE\' THEN SPEND END) AS AMAZON_ADS_DE_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_DE\' THEN SPEND END) AS AMAZON_ADS_DE_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_DE\' THEN SPEND END) AS AMAZON_ADS_DE_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_DE\' THEN SPEND END) AS AMAZON_ADS_DE_SPEND_SPONSORED_BRANDS FROM Vahdam_db.maplemonk.AMAZONADS_EU_MARKETING GROUP BY DATE) AZ ON CTE.DATE=AZ.DATE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CHANNEL=\'Google Ads\' THEN SPEND END) AS GOOGLE_ADS_GERMANY_SPEND, SUM(CASE WHEN CHANNEL=\'Facebook Ads\' THEN SPEND END) AS FACEBOOK_ADS_GERMANY_SPEND FROM Vahdam_db.maplemonk.GERMANY_MARKETING_CONSOLIDATED GROUP BY DATE) FG ON CTE.DATE=FG.DATE ORDER BY CTE.DATE DESC; CREATE OR REPLACE TABLE VAHDAM_DB.MAPLEMONK.Global_DSR AS WITH CTE AS (SELECT FI.ORDER_TIMESTAMP::date AS DATE, UPPER(DAYNAME(FI.ORDER_TIMESTAMP::DATE)) AS Day, SUM(CASE WHEN FI.shop_name=\'Shopify_Global\' THEN FI.Net_Sales END) AS Shopify_Global_Sales_USD, SUM(CASE WHEN FI.shop_name=\'Shopify_Global\' THEN FI.Net_Sales_INR END) AS Shopify_Global_Sales_INR, SUM(CASE WHEN FI.shop_name=\'Amazon_UK\' THEN FI.Net_Sales END) AS Amazon_UK_Sales_GBP, SUM(CASE WHEN FI.shop_name=\'Amazon_UK\' THEN FI.Net_Sales_INR END) AS Amazon_UK_Sales_INR, SUM(CASE WHEN FI.shop_name=\'Amazon_ESP\' THEN FI.Net_Sales END) AS Amazon_Spain_Sales_EUR, SUM(CASE WHEN FI.shop_name=\'Amazon_ESP\' THEN FI.Net_Sales_INR END) AS Amazon_Spain_Sales_INR, SUM(CASE WHEN FI.shop_name=\'Amazon_FR\' THEN FI.Net_Sales END) AS Amazon_France_Sales_EUR, SUM(CASE WHEN FI.shop_name=\'Amazon_FR\' THEN FI.Net_Sales_INR END) AS Amazon_France_Sales_INR FROM Vahdam_db.maplemonk.FACT_ITEMS FI WHERE FI.is_refund=0 GROUP BY FI.ORDER_TIMESTAMP::date ORDER BY FI.ORDER_TIMESTAMP::date DESC) SELECT CTE.*, AZ.AMAZON_ADS_ESP_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_ESP_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_ESP_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_ESP_SPEND_SPONSORED_BRANDS, AZ.AMAZON_ADS_UK_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_UK_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_UK_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_UK_SPEND_SPONSORED_BRANDS, AZ.AMAZON_ADS_FR_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_FR_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_FR_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_FR_SPEND_SPONSORED_BRANDS, FG.GOOGLE_ADS_GLOBAL_SPEND, FG.FACEBOOK_ADS_GLOBAL_SPEND FROM CTE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_ESP\' THEN SPEND END) AS AMAZON_ADS_ESP_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_ESP\' THEN SPEND END) AS AMAZON_ADS_ESP_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_ESP\' THEN SPEND END) AS AMAZON_ADS_ESP_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_ESP\' THEN SPEND END) AS AMAZON_ADS_ESP_SPEND_SPONSORED_BRANDS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_UK\' THEN SPEND END) AS AMAZON_ADS_UK_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_UK\' THEN SPEND END) AS AMAZON_ADS_UK_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_UK\' THEN SPEND END) AS AMAZON_ADS_UK_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_UK\' THEN SPEND END) AS AMAZON_ADS_UK_SPEND_SPONSORED_BRANDS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_FR\' THEN SPEND END) AS AMAZON_ADS_FR_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_FR\' THEN SPEND END) AS AMAZON_ADS_FR_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_FR\' THEN SPEND END) AS AMAZON_ADS_FR_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_FR\' THEN SPEND END) AS AMAZON_ADS_FR_SPEND_SPONSORED_BRANDS FROM Vahdam_db.maplemonk.AMAZONADS_EU_MARKETING GROUP BY DATE) AZ ON CTE.DATE=AZ.DATE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CHANNEL=\'Google Ads\' THEN SPEND END) AS GOOGLE_ADS_GLOBAL_SPEND, SUM(CASE WHEN CHANNEL=\'Facebook Ads\' THEN SPEND END) AS FACEBOOK_ADS_GLOBAL_SPEND FROM Vahdam_db.maplemonk.GLOBAL_MARKETING_CONSOLIDATED GROUP BY DATE) FG ON CTE.DATE=FG.DATE ORDER BY CTE.DATE DESC;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from VAHDAM_DB.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        