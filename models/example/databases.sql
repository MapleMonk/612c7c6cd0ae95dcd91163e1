{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "create or replace table ttk_db.maplemonk.ttk_db_wareiq_fact_items as select * from (select \'LD\' WAREIQ_ACCOUNT ,ORDER_ID ,STATUS ,SHIPPING_DETAILS:awb::string AWB ,upper(SHIPPING_DETAILS:courier::string) COURIER ,SHIPPING_DETAILS:damage_reason::string DAMAGE_REASON ,PAYMENT:collectable_amount::float as COLLECTABLE_AMOUNT ,upper(PAYMENT:mode::string) PAYMENT_MODE ,VOLUMETRIC ,upper(ERROR_REASON) ERROR_REASON ,try_to_timestamp(MANIFEST_TIME, \'DD MON YYYY, HH:MI PM\') MANIFEST_TIME ,try_to_timestamp(DELIVERED_TIME, \'DD MON YYYY, HH:MI PM\') DELIVERED_TIME ,try_to_timestamp(last_updated, \'YYYY-MM-DD HH:MI:SS\') LAST_UPDATED_TIME ,row_number() over (partition by AWB, ORDER_ID order by try_to_timestamp(last_updated, \'YYYY-MM-DD HH:MI:SS\') desc, _airbyte_emitted_at desc) rw from ttk_db.maplemonk.wareiq_ld_orders ) where rw=1 union all select * from (select \'SKORE\' WAREIQ_ACCOUNT ,ORDER_ID ,STATUS ,SHIPPING_DETAILS:awb::string AWB ,upper(SHIPPING_DETAILS:courier::string) COURIER ,SHIPPING_DETAILS:damage_reason::string DAMAGE_REASON ,PAYMENT:collectable_amount::float as COLLECTABLE_AMOUNT ,upper(PAYMENT:mode::string) PAYMENT_MODE ,VOLUMETRIC ,upper(ERROR_REASON) ERROR_REASON ,try_to_timestamp(MANIFEST_TIME, \'DD MON YYYY, HH:MI PM\') MANIFEST_TIME ,try_to_timestamp(DELIVERED_TIME, \'DD MON YYYY, HH:MI PM\') DELIVERED_TIME ,try_to_timestamp(last_updated, \'YYYY-MM-DD HH:MI:SS\') LAST_UPDATED_TIME ,row_number() over (partition by AWB, ORDER_ID order by try_to_timestamp(last_updated, \'YYYY-MM-DD HH:MI:SS\') desc, _airbyte_emitted_at desc) rw from ttk_db.maplemonk.wareiq_skore_orders ) where rw=1 union all select * from (select \'MKP\' WAREIQ_ACCOUNT ,ORDER_ID ,STATUS ,SHIPPING_DETAILS:awb::string AWB ,upper(SHIPPING_DETAILS:courier::string) COURIER ,SHIPPING_DETAILS:damage_reason::string DAMAGE_REASON ,PAYMENT:collectable_amount::float as COLLECTABLE_AMOUNT ,upper(PAYMENT:mode::string) PAYMENT_MODE ,VOLUMETRIC ,upper(ERROR_REASON) ERROR_REASON ,try_to_timestamp(MANIFEST_TIME, \'DD MON YYYY, HH:MI PM\') MANIFEST_TIME ,try_to_timestamp(DELIVERED_TIME, \'DD MON YYYY, HH:MI PM\') DELIVERED_TIME ,try_to_timestamp(last_updated, \'YYYY-MM-DD HH:MI:SS\') LAST_UPDATED_TIME ,row_number() over (partition by AWB, ORDER_ID order by try_to_timestamp(last_updated, \'YYYY-MM-DD HH:MI:SS\') desc, _airbyte_emitted_at desc) rw from ttk_db.maplemonk.wareiq_mkp_orders ) where rw=1 union all select * from (select \'MSC\' WAREIQ_ACCOUNT ,ORDER_ID ,STATUS ,SHIPPING_DETAILS:awb::string AWB ,upper(SHIPPING_DETAILS:courier::string) COURIER ,SHIPPING_DETAILS:damage_reason::string DAMAGE_REASON ,PAYMENT:collectable_amount::float as COLLECTABLE_AMOUNT ,upper(PAYMENT:mode::string) PAYMENT_MODE ,VOLUMETRIC ,upper(ERROR_REASON) ERROR_REASON ,try_to_timestamp(MANIFEST_TIME, \'DD MON YYYY, HH:MI PM\') MANIFEST_TIME ,try_to_timestamp(DELIVERED_TIME, \'DD MON YYYY, HH:MI PM\') DELIVERED_TIME ,try_to_timestamp(last_updated, \'YYYY-MM-DD HH:MI:SS\') LAST_UPDATED_TIME ,row_number() over (partition by AWB, ORDER_ID order by try_to_timestamp(last_updated, \'YYYY-MM-DD HH:MI:SS\') desc, _airbyte_emitted_at desc) rw from ttk_db.maplemonk.wareiq_msc_orders ) where rw=1;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from ttk_db.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        