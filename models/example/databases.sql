{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "create or replace table eggozdb.maplemonk.first_mile as SELECT pp.id as procurement_id, cast(timestampadd(minute, 660, po_date) as date) as po_date, ff.farm_name, wd.driver_name, wd.driver_no as driver_phone_no, wv.vehicle_no, sum(pb.expected_egg_tray) expected_tray_quantity, sum(pb.actual_egg_tray) actual_tray_quantity, sum(pb.expected_egg_tray*30) expected_egg_quantity, sum(pb.actual_egg_tray*30) actual_egg_quantity, ww.name warehouse, wv.per_day_charge, wv.per_day_distance, wv.per_day_duration, wv.vehicle_identifier_type, pp.procurement_bill_url, pp.extra_egg_trays_charge, pp.additional_charge, pp.loading_charge, pp.packaging_charge FROM eggozdb.maplemonk.my_sql_procurement_procurement pp left join eggozdb.maplemonk.my_sql_farmer_farm ff on ff.id = pp.farm_id left join eggozdb.maplemonk.my_sql_warehouse_driver wd on wd.id = pp.driver_id left join eggozdb.maplemonk.my_sql_warehouse_vehicle wv on wv.id = pp.vehicle_id left join eggozdb.maplemonk.my_sql_procurement_batchmodel pb on pb.procurement_id = pp.id left join eggozdb.maplemonk.my_sql_warehouse_warehouse ww on ww.id = pp.warehouse_id group by pp.id, cast(timestampadd(minute, 660, po_date) as date), ff.farm_name, wd.driver_name, wd.driver_no, wv.vehicle_no, ww.name, wv.per_day_charge, wv.per_day_distance, wv.per_day_duration, pp.procurement_bill_url, pp.extra_egg_trays_charge, pp.additional_charge, pp.loading_charge, pp.packaging_charge, wv.vehicle_identifier_type ; create or replace table eggozdb.maplemonk.mid_mile as SELECT dt.id, cast(timestampadd(minute,660,dt.beat_date) as date) beat_date, cast(timestampadd(minute,660,dt.transferred_at) as time) transferred_at, cast(timestampadd(minute,660,dt.vehicle_assigned_at) as datetime) vehicle_assigned_at, cast(timestampadd(minute,660,dt.received_at) as datetime) received_at, ww1.name transfered_from, ww2.name transfered_to, sum(dts.quantity*pp.SKU_Count) as sent_eggs_ims, sum(dts.receive_quantity*pp.SKU_Count) as received_eggs_ims, wd.driver_name, wv.vehicle_no, wv.per_day_charge, wv.per_day_distance, wv.per_day_duration, wv.vehicle_identifier_type FROM eggozdb.maplemonk.my_sql_distributionchain_tripskutransfer dt right join eggozdb.maplemonk.my_sql_distributionchain_transfersku dts on dt.id = dts.tripSKUTransfer_id left join eggozdb.maplemonk.my_sql_product_product pp on dts.product_id = pp.id left join eggozdb.maplemonk.my_sql_warehouse_warehouse ww1 on ww1.id = dt.from_warehouse_id left join eggozdb.maplemonk.my_sql_warehouse_warehouse ww2 on ww2.id = dt.to_warehouse_id left join eggozdb.maplemonk.my_sql_retailer_retailerbeat rrb on dt.to_beat_id = rrb.id left join eggozdb.maplemonk.my_sql_retailer_retailerbeat rrb2 on dt.from_beat_id = rrb2.id left join eggozdb.maplemonk.my_sql_warehouse_driver wd on wd.id = dt.driver_id left join eggozdb.maplemonk.my_sql_warehouse_vehicle wv on wv.id = dt.vehicle_id where dt.material_type = \'Fresh\' and lower(transfer_status) = \'confirmed\' and dt.transfer_type = \'satellite\' group by dt.id, cast(timestampadd(minute,660,dt.beat_date) as date), cast(timestampadd(minute,660,dt.transferred_at) as time), cast(timestampadd(minute,660,dt.vehicle_assigned_at) as datetime), cast(timestampadd(minute,660,dt.received_at) as datetime), ww1.name, ww2.name, wd.driver_name, wv.vehicle_no, wv.per_day_charge, wv.per_day_distance, wv.per_day_duration, wv.vehicle_identifier_type ; create or replace table eggozdb.maplemonk.last_mile as select cast(timestampadd(minute, 660, db.beat_date) as date) beat_date, db.beat_number, db.beat_status, cast(timestampadd(minute, 660, db.beat_time) as time) beat_time, wd.driver_name, wv.vehicle_no, wv.per_day_charge, wv.per_day_distance, wv.per_day_duration, wv.vehicle_identifier_type, cast(timestampadd(minute, 660, db.beat_expected_time) as time) beat_expected_time, db.beat_material_status, db.priority, ww.name warehouse, db.ODO_in, db.ODO_return, cast(timestampadd(minute, 660, db.in_time) as time) in_time, cast(timestampadd(minute, 660, db.out_time) as time) out_time, cast(timestampadd(minute, 660, db.return_time) as time) return_time, cast(timestampadd(minute, 660, db.sc_in_time) as time) sc_in_time, db.beat_type, db.distributor_trip_status, db.finance_trip_status, db.warehouse_trip_status, db.demand_classification, db.supply_approval_status, cast(timestampadd(minute, 660, db.cancelled_at) as datetime) cancelled_at, cast(timestampadd(minute, 660, db.vehicle_assigned_at) as datetime) vehicle_assigned_at, cast(timestampadd(minute, 660, db.created_at) as datetime) created_at, cast(timestampadd(minute, 660, db.modified_at) as datetime) modified_at, cast(timestampadd(minute, 660, db.out_date) as date) out_date, cast(timestampadd(minute, 660, db.return_date) as date) return_date, db.beat_brand_type from eggozdb.maplemonk.my_sql_distributionchain_beatassignment db left join eggozdb.maplemonk.my_sql_warehouse_driver wd on wd.id = db.driver_id left join eggozdb.maplemonk.my_sql_warehouse_vehicle wv on wv.id = db.vehicle_id left join eggozdb.maplemonk.my_sql_warehouse_warehouse ww on ww.id = db.warehouse_id ;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from EGGOZDB.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        