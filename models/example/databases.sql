{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "create or replace table charak_db.maplemonk.magento_Fact_items as select null as customer_id ,\'MAGENTO VEDISTRY\' SHOP_NAME ,\'MAGENTO VEDISTRY\' as marketplace ,null AS CHANNEL ,null AS SOURCE ,quote_id ORDER_ID ,increment_id reference_code ,billing_address:telephone::string PHONE ,concat(customer_firstname,\' \',customer_lastname) NAME ,coalesce(customer_email, billing_address:email::string) EMAIL ,updated_At::date SHIPPING_LAST_UPDATE_DATE ,value:sku::String SKU ,value:item_id::String PRODUCT_ID ,Upper(value:name::String) PRODUCT_NAME ,base_currency_code CURRENCY ,Upper(billing_address:city::string) As CITY ,Upper(billing_address:region::string) AS State ,Upper(status) ORDER_STATUS ,created_at::date AS Order_Date ,value:qty_ordered::int QUANTITY ,value:base_price::float AS GROSS_SALES_BEFORE_TAX ,value:discount_amount::float AS DISCOUNT ,value:base_tax_amount::float TAX ,null as SHIPPING_PRICE ,value:base_row_total_incl_tax::float AS SELLING_PRICE ,null OMS_order_status ,null AS SHIPPING_STATUS ,null FINAL_SHIPPING_STATUS ,value:quote_item_id::varchar as SALEORDERITEMCODE ,value:quote_item_id::varchar as SALES_ORDER_ITEM_ID ,null AWB ,null PAYMENT_GATEWAY ,upper(payment:method::string) Payment_Mode ,null AS COURIER ,null AS DISPATCH_DATE ,null AS DELIVERED_DATE ,null DELIVERED_STATUS ,case when value:qty_refunded::varchar <> \'0\' then 1 else 0 end AS is_refund ,null returned_quantity ,null returned_sales ,case when lower(status) in (\'canceled\') then value:qty_ordered::int end cancelled_quantity ,null NEW_CUSTOMER_FLAG from charak_db.maplemonk.magento_vedistry_orders, lateral flatten (input => items) union all select null as customer_id ,\'MAGENTO MOHA\' SHOP_NAME ,\'MAGENTO MOHA\' as marketplace ,null AS CHANNEL ,null AS SOURCE ,quote_id ORDER_ID ,increment_id reference_code ,billing_address:telephone::string PHONE ,concat(customer_firstname,\' \',customer_lastname) NAME ,coalesce(customer_email, billing_address:email::string) EMAIL ,updated_At::date SHIPPING_LAST_UPDATE_DATE ,value:sku::String SKU ,value:item_id::String PRODUCT_ID ,Upper(value:name::String) PRODUCT_NAME ,base_currency_code CURRENCY ,Upper(billing_address:city::string) As CITY ,Upper(billing_address:region::string) AS State ,Upper(status) ORDER_STATUS ,created_at::date AS Order_Date ,value:qty_ordered::int QUANTITY ,value:base_price::float AS GROSS_SALES_BEFORE_TAX ,value:discount_amount::float AS DISCOUNT ,value:base_tax_amount::float TAX ,null as SHIPPING_PRICE ,value:base_row_total_incl_tax::float AS SELLING_PRICE ,null OMS_order_status ,null AS SHIPPING_STATUS ,null FINAL_SHIPPING_STATUS ,value:quote_item_id::varchar as SALEORDERITEMCODE ,value:quote_item_id::varchar as SALES_ORDER_ITEM_ID ,null AWB ,null PAYMENT_GATEWAY ,upper(payment:method::string) Payment_Mode ,null AS COURIER ,null AS DISPATCH_DATE ,null AS DELIVERED_DATE ,null DELIVERED_STATUS ,case when value:qty_refunded::varchar <> \'0\' then 1 else 0 end AS is_refund ,null returned_quantity ,null returned_sales ,case when lower(status) in (\'canceled\') then value:qty_ordered::int end cancelled_quantity ,null NEW_CUSTOMER_FLAG from charak_db.maplemonk.magento_moha_orders, lateral flatten (input => items) ;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from charak_db.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        