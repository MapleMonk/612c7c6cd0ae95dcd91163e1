{{ config(
            materialized='table',
                post_hook={
                    "sql": "CREATE OR REPLACE TABLE VAHDAM_DB.MAPLEMONK.AMAZONADS_NA_CONSOLIDATED AS SELECT 'SPONSORED PRODUCTS' CAMPAIGN_TYPE, CAMPAIGNID, CAMPAIGNNAME, ADGROUPID, ADGROUPNAME, KEYWORDTEXT, NULL AD_ID ,SKU, ASIN, OTHERASIN ,SUM(IMPRESSIONS) IMPRESSIONS ,SUM(CLICKS) CLICKS ,SUM(COST) COST ,SUM(ATTRIBUTEDSALES14D) AS SALES ,SUM(ATTRIBUTEDCONVERSIONS14D) AS CONVERSIONS ,SUM(ATTRIBUTEDUNITSORDERED14D) AS UNITS_ORDERED ,SUM(ATTRIBUTEDSALES14DSAMESKU) AS SAME_SKU_SALES ,SUM(ATTRIBUTEDCONVERSIONS14DSAMESKU) AS SAME_SKU_CONVERSIONS ,SUM(ATTRIBUTEDUNITSORDERED14DSAMESKU) AS SAME_SKU_UNITS ,SUM(ATTRIBUTEDSALES14DOTHERSKU) AS OTHER_SKU_SALES ,SUM((ATTRIBUTEDCONVERSIONS14D - ATTRIBUTEDCONVERSIONS14DSAMESKU)) AS OTHER_SKU_CONVERSIONS ,SUM(ATTRIBUTEDUNITSORDERED14DOTHERSKU) AS OTHER_SKU_UNITS FROM VAHDAM_DB.MAPLEMONK.AMAZONADS_NA_SPONSORED_PRODUCTS_REPORT_STREAM_METRIC GROUP BY CAMPAIGNID, CAMPAIGNNAME, ADGROUPID, ADGROUPNAME, KEYWORDTEXT, AD_ID, SKU, ASIN, OTHERASIN UNION SELECT 'SPONSORED DISPLAY' CAMPAIGN_TYPE, CAMPAIGNID, CAMPAIGNNAME, ADGROUPID, ADGROUPNAME, NULL, ADID ,SKU, ASIN, OTHERASIN ,SUM(IMPRESSIONS) IMPRESSIONS ,SUM(CLICKS) CLICKS ,SUM(COST) COST ,SUM(ATTRIBUTEDSALES14D) AS SALES ,SUM(ATTRIBUTEDCONVERSIONS14D) AS CONVERSIONS ,SUM(ATTRIBUTEDUNITSORDERED14D) AS UNITS_ORDERED ,SUM(ATTRIBUTEDSALES14DSAMESKU) AS SAME_SKU_SALES ,SUM(ATTRIBUTEDCONVERSIONS14DSAMESKU) AS SAME_SKU_COVERSIONS ,SUM((ATTRIBUTEDUNITSORDERED14D-ATTRIBUTEDUNITSORDERED14DOTHERSKU)) AS SAME_SKU_UNITS ,SUM(ATTRIBUTEDSALES14DOTHERSKU) AS OTHER_SKU_SALES ,SUM((ATTRIBUTEDCONVERSIONS14D-ATTRIBUTEDCONVERSIONS14DSAMESKU)) AS OTHER_SKU_CONVERSIONS ,SUM(ATTRIBUTEDUNITSORDERED14DOTHERSKU) AS OTHER_SKU_UNITS FROM VAHDAM_DB.MAPLEMONK.AMAZONADS_NA_SPONSORED_DISPLAY_REPORT_STREAM_METRIC GROUP BY CAMPAIGNID, CAMPAIGNNAME, ADGROUPID, ADGROUPNAME, ADID, SKU, ASIN, OTHERASIN UNION SELECT 'SPONSORED BRANDS' CAMPAIGN_TYPE, CAMPAIGNID, CAMPAIGNNAME, ADGROUPID, ADGROUPNAME, KEYWORDTEXT, NULL ,NULL, NULL, NULL ,SUM(IMPRESSIONS) IMPRESSIONS ,SUM(CLICKS) CLICKS ,SUM(COST) COST ,SUM(ATTRIBUTEDSALES14D) AS SALES ,SUM(ATTRIBUTEDCONVERSIONS14D) AS CONVERSIONS, NULL UNITS_ORDERED ,SUM(ATTRIBUTEDSALES14DSAMESKU) AS SAME_SKU_SALES ,SUM(ATTRIBUTEDCONVERSIONS14DSAMESKU) AS SAME_SKU_CONVERSIONS, NULL SAME_SKU_UNITS ,SUM((ATTRIBUTEDSALES14D-ATTRIBUTEDSALES14DSAMESKU)) AS OTHER_SKU_SALES ,SUM((ATTRIBUTEDCONVERSIONS14D-ATTRIBUTEDCONVERSIONS14DSAMESKU)) AS OTHER_SKU_CONVERSIONS, NULL OTHER_SKU_UNITS FROM VAHDAM_DB.MAPLEMONK.AMAZONADS_NA_SPONSORED_BRANDS_REPORT_STREAM_METRIC GROUP BY CAMPAIGNID, CAMPAIGNNAME, ADGROUPID, ADGROUPNAME, KEYWORDTEXT UNION SELECT 'SPONSORED BRANDS VIDEO' CAMPAIGN_TYPE, CAMPAIGNID, CAMPAIGNNAME, ADGROUPID, ADGROUPNAME, KEYWORDTEXT, NULL ,NULL, NULL, NULL ,SUM(IMPRESSIONS) IMPRESSIONS ,SUM(CLICKS) CLICKS ,SUM(COST) COST ,SUM(ATTRIBUTEDSALES14D) AS SALES ,SUM(ATTRIBUTEDCONVERSIONS14D) AS CONVERSIONS, NULL UNITS_ORDERED ,SUM(ATTRIBUTEDSALES14DSAMESKU) AS SAME_SKU_SALES ,SUM(ATTRIBUTEDCONVERSIONS14DSAMESKU) AS SAME_SKU_CONVERSIONS, NULL SAME_SKU_UNITS ,SUM((ATTRIBUTEDSALES14D-ATTRIBUTEDSALES14DSAMESKU)) AS OTHER_SKU_SALES ,SUM((ATTRIBUTEDCONVERSIONS14D-ATTRIBUTEDCONVERSIONS14DSAMESKU)) AS OTHER_SKU_CONVERSIONS, NULL OTHER_SKU_UNITS FROM VAHDAM_DB.MAPLEMONK.AMAZONADS_NA_SPONSORED_BRANDS_VIDEO_REPORT_STREAM_METRIC GROUP BY CAMPAIGNID, CAMPAIGNNAME, ADGROUPID, ADGROUPNAME, KEYWORDTEXT",
                    "transaction": true
                }
            ) }}
            with sample_data as (

                select * from VAHDAM_DB.information_schema.databases
            ),
            
            final as (
                select * from sample_data
            )
            select * from final
            