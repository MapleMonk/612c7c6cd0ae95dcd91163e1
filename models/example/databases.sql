{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "create or replace table SELECT_DB.MAPLEMONK.SELECT_DB_sku_master as select * from (select * ,row_number() over (partition by lower(marketplace_sku) order by 1) rw from ( select upper(Shopify_SKU) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(CommonSKUID) CommonSKUID from (select CommonSKUID , \"PRODUCT TITLE\" name , category , sub_category , shopify Shopify_SKU , row_number() over (partition by lower(shopify) order by 1) rw from SELECT_DB.MAPLEMONK.mapping_sku_master ) where rw = 1 and not(upper(Shopify_SKU) like any (\'#N/A\', \'0\', \'NA\', \'%NOT%\') or upper(Shopify_SKU) is null) union select upper(Flipkart_ID) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(CommonSKUID) CommonSKUID from (select CommonSKUID , \"PRODUCT TITLE\" name , category , sub_category , Flipkart_ID Flipkart_ID , row_number() over (partition by lower(Flipkart_ID) order by 1) rw from SELECT_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and not(upper(Flipkart_ID) like any (\'#N/A\', \'0\', \'NA\', \'%NOT%\') or upper(Flipkart_ID) is null) union select upper(PEPPERFRY_SKU) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(CommonSKUID) CommonSKUID from (select CommonSKUID , \"PRODUCT TITLE\" name , category , sub_category , Pepperfry PEPPERFRY_SKU , row_number() over (partition by lower(Pepperfry) order by 1) rw from SELECT_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and not(upper(PEPPERFRY_SKU) like any (\'#N/A\', \'0\', \'NA\', \'%NOT%\') or upper(PEPPERFRY_SKU) is null) union select upper(AMAZON_VC_SKU) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(CommonSKUID) CommonSKUID from (select CommonSKUID , \"PRODUCT TITLE\" name , category , sub_category , Amazon_VC AMAZON_VC_SKU , row_number() over (partition by lower(Amazon_VC) order by 1) rw from SELECT_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and not(upper(AMAZON_VC_SKU) like any (\'#N/A\', \'0\', \'NA\', \'%NOT%\') or upper(AMAZON_VC_SKU) is null) union select upper(AMAZON_SC_SKU) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(CommonSKUID) CommonSKUID from (select CommonSKUID , \"PRODUCT TITLE\" name , category , sub_category , Amazon_SC AMAZON_SC_SKU , row_number() over (partition by lower(Amazon_SC) order by 1) rw from SELECT_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and not(upper(AMAZON_SC_SKU) like any (\'#N/A\', \'0\', \'NA\', \'%NOT%\') or upper(AMAZON_SC_SKU) is null) ) ) where rw=1 ;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from SELECT_DB.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        