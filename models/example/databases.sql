{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "create or replace table vahdam_db.maplemonk.GA_Sessions_Consolidated as select \'Shopify_USA\' as Region ,ga_date ,view_id ,ga_exits ,ga_users ,ga_campaign ,ga_newusers ,ga_sessions ,ga_pageviews ,ga_sourcemedium ,ga_uniquepageviews ,ga_avgsessionduration ,case when lower(GA_SOURCEMEDIUM) like any (\'%facebook%\',\'%fb%\') then \'Facebook\' when lower(GA_SOURCEMEDIUM) like any (\'%instagram%\',\'%igshopping%\',\'%insta%\',\'%ig%\') then \'Instagram\' when lower(GA_SOURCEMEDIUM) like any (\'%google%\',\'%youtube%\',\'%yt%\') then \'Google\' when lower(GA_SOURCEMEDIUM) like \'%duckduckgo%\' then \'Duckduckgo\' when lower(GA_SOURCEMEDIUM) like \'%bing%\' then \'Bing\' when lower(GA_SOURCEMEDIUM) like \'%yahoo%\' then \'Yahoo\' when lower(GA_SOURCEMEDIUM) like \'%direct%\' then \'Direct\' when lower(GA_SOURCEMEDIUM) like \'%attentive%\' then \'Attentive\' when lower(GA_SOURCEMEDIUM) like \'%pushowl%\' then \'PushOwl\' when lower(GA_SOURCEMEDIUM) like any (\'%email%\',\'%klaviyo%\') then \'Email\' when lower(GA_SOURCEMEDIUM) like any (\'%affiliate%\',\'%affliate%\') then \'Affiliate\' when lower(GA_SOURCEMEDIUM) like \'%content%\' then \'Content\' when lower(GA_SOURCEMEDIUM) like \'%referral%\' then \'Referral\' when lower(GA_SOURCEMEDIUM) like \'%tiktok%\' then \'TikTok\' when lower(GA_SOURCEMEDIUM) like \'%sms%\' then \'SMS\' when lower(GA_SOURCEMEDIUM) like \'%telegram%\' then \'Telegram\' when lower(GA_SOURCEMEDIUM) like \'%twitter%\' then \'Twitter\' when lower(GA_SOURCEMEDIUM) like \'%pinterest%\' then \'Pinterest\' when lower(GA_SOURCEMEDIUM) like \'%linkedin%\' then \'LinkedIn\' else \'Others\' end as Final_Channel ,coalesce(GADSC.\"campaign.advertising_channel_type\",MC.AD_NETWORK_TYPE) CAMPAIGN_TYPE from VAHDAM_DB.MAPLEMONK.GA_US_WEBSITE_SESSIONS_BY_DATE_CAMPAIGN_SOURCE GASE left join (select * from (select *, row_number() over (partition by \"campaign.name\" order by \"segments.date\" desc) rw from VAHDAM_DB.MAPLEMONK.GOOGLE_ADS_US_CAMPAIGN_DATA) where rw=1) GADSC on lower(GADSC.\"campaign.name\") = lower(GASE.ga_campaign) left join (select * from (select *, row_number() over (partition by campaign_name order by date desc) rw from VAHDAM_DB.MAPLEMONK.marketing_consolidated) where rw=1) MC on lower(GASE.ga_campaign) = lower(MC.campaign_name) Union all select \'Shopify_Germany\' as Region ,ga_date ,view_id ,ga_exits ,ga_users ,ga_campaign ,ga_newusers ,ga_sessions ,ga_pageviews ,ga_sourcemedium ,ga_uniquepageviews ,ga_avgsessionduration ,case when lower(GA_SOURCEMEDIUM) like any (\'%facebook%\',\'%fb%\') then \'Facebook\' when lower(GA_SOURCEMEDIUM) like any (\'%instagram%\',\'%igshopping%\',\'%insta%\',\'%ig%\') then \'Instagram\' when lower(GA_SOURCEMEDIUM) like any (\'%google%\',\'%youtube%\',\'%yt%\') then \'Google\' when lower(GA_SOURCEMEDIUM) like \'%duckduckgo%\' then \'Duckduckgo\' when lower(GA_SOURCEMEDIUM) like \'%bing%\' then \'Bing\' when lower(GA_SOURCEMEDIUM) like \'%yahoo%\' then \'Yahoo\' when lower(GA_SOURCEMEDIUM) like \'%direct%\' then \'Direct\' when lower(GA_SOURCEMEDIUM) like \'%attentive%\' then \'Attentive\' when lower(GA_SOURCEMEDIUM) like \'%pushowl%\' then \'PushOwl\' when lower(GA_SOURCEMEDIUM) like any (\'%email%\',\'%klaviyo%\') then \'Email\' when lower(GA_SOURCEMEDIUM) like any (\'%affiliate%\',\'%affliate%\') then \'Affiliate\' when lower(GA_SOURCEMEDIUM) like \'%content%\' then \'Content\' when lower(GA_SOURCEMEDIUM) like \'%referral%\' then \'Referral\' when lower(GA_SOURCEMEDIUM) like \'%tiktok%\' then \'TikTok\' when lower(GA_SOURCEMEDIUM) like \'%sms%\' then \'SMS\' when lower(GA_SOURCEMEDIUM) like \'%telegram%\' then \'Telegram\' when lower(GA_SOURCEMEDIUM) like \'%twitter%\' then \'Twitter\' when lower(GA_SOURCEMEDIUM) like \'%pinterest%\' then \'Pinterest\' when lower(GA_SOURCEMEDIUM) like \'%linkedin%\' then \'LinkedIn\' else \'Others\' end as Final_Channel ,coalesce(GADSC.\"campaign.advertising_channel_type\",MC.AD_NETWORK_TYPE) CAMPAIGN_TYPE from VAHDAM_DB.MAPLEMONK.GA_DE_WEBSITE_SESSIONS_BY_DATE_CAMPAIGN_SOURCE GASE left join (select * from (select *, row_number() over (partition by \"campaign.name\" order by \"segments.date\" desc) rw from VAHDAM_DB.MAPLEMONK.GOOGLE_ADS_GERMANY_CAMPAIGN_DATA) where rw=1) GADSC on lower(GADSC.\"campaign.name\") = lower(GASE.ga_campaign) left join (select * from (select *, row_number() over (partition by campaign_name order by date desc) rw from Vahdam_db.maplemonk.GERMANY_MARKETING_CONSOLIDATED) where rw=1) MC on lower(GASE.ga_campaign) = lower(MC.campaign_name) Union all select \'Shopify_Global\' as Region ,ga_date ,view_id ,ga_exits ,ga_users ,ga_campaign ,ga_newusers ,ga_sessions ,ga_pageviews ,ga_sourcemedium ,ga_uniquepageviews ,ga_avgsessionduration ,case when lower(GA_SOURCEMEDIUM) like any (\'%facebook%\',\'%fb%\') then \'Facebook\' when lower(GA_SOURCEMEDIUM) like any (\'%instagram%\',\'%igshopping%\',\'%insta%\',\'%ig%\') then \'Instagram\' when lower(GA_SOURCEMEDIUM) like any (\'%google%\',\'%youtube%\',\'%yt%\') then \'Google\' when lower(GA_SOURCEMEDIUM) like \'%duckduckgo%\' then \'Duckduckgo\' when lower(GA_SOURCEMEDIUM) like \'%bing%\' then \'Bing\' when lower(GA_SOURCEMEDIUM) like \'%yahoo%\' then \'Yahoo\' when lower(GA_SOURCEMEDIUM) like \'%direct%\' then \'Direct\' when lower(GA_SOURCEMEDIUM) like \'%attentive%\' then \'Attentive\' when lower(GA_SOURCEMEDIUM) like \'%pushowl%\' then \'PushOwl\' when lower(GA_SOURCEMEDIUM) like any (\'%email%\',\'%klaviyo%\') then \'Email\' when lower(GA_SOURCEMEDIUM) like any (\'%affiliate%\',\'%affliate%\') then \'Affiliate\' when lower(GA_SOURCEMEDIUM) like \'%content%\' then \'Content\' when lower(GA_SOURCEMEDIUM) like \'%referral%\' then \'Referral\' when lower(GA_SOURCEMEDIUM) like \'%tiktok%\' then \'TikTok\' when lower(GA_SOURCEMEDIUM) like \'%sms%\' then \'SMS\' when lower(GA_SOURCEMEDIUM) like \'%telegram%\' then \'Telegram\' when lower(GA_SOURCEMEDIUM) like \'%twitter%\' then \'Twitter\' when lower(GA_SOURCEMEDIUM) like \'%pinterest%\' then \'Pinterest\' when lower(GA_SOURCEMEDIUM) like \'%linkedin%\' then \'LinkedIn\' else \'Others\' end as Final_Channel ,coalesce(GADSC.\"campaign.advertising_channel_type\",MC.AD_NETWORK_TYPE) CAMPAIGN_TYPE from VAHDAM_DB.MAPLEMONK.GA_GLOBAL_WEBSITE_SESSIONS_BY_DATE_CAMPAIGN_SOURCE GASE left join (select * from (select *, row_number() over (partition by \"campaign.name\" order by \"segments.date\" desc) rw from VAHDAM_DB.MAPLEMONK.GOOGLE_ADS_GLOBAL_CAMPAIGN_DATA) where rw=1) GADSC on lower(GADSC.\"campaign.name\") = lower(GASE.ga_campaign) left join (select * from (select *, row_number() over (partition by campaign_name order by date desc) rw from Vahdam_db.maplemonk.global_marketing_consolidated) where rw=1) MC on lower(GASE.ga_campaign) = lower(MC.campaign_name) Union all select \'Shopify_India\' as Region ,ga_date ,view_id ,ga_exits ,ga_users ,ga_campaign ,ga_newusers ,ga_sessions ,ga_pageviews ,ga_sourcemedium ,ga_uniquepageviews ,ga_avgsessionduration ,case when lower(GA_SOURCEMEDIUM) like any (\'%facebook%\',\'%fb%\') then \'Facebook\' when lower(GA_SOURCEMEDIUM) like any (\'%instagram%\',\'%igshopping%\',\'%insta%\',\'%ig%\') then \'Instagram\' when lower(GA_SOURCEMEDIUM) like any (\'%google%\',\'%youtube%\',\'%yt%\') then \'Google\' when lower(GA_SOURCEMEDIUM) like \'%duckduckgo%\' then \'Duckduckgo\' when lower(GA_SOURCEMEDIUM) like \'%bing%\' then \'Bing\' when lower(GA_SOURCEMEDIUM) like \'%yahoo%\' then \'Yahoo\' when lower(GA_SOURCEMEDIUM) like \'%direct%\' then \'Direct\' when lower(GA_SOURCEMEDIUM) like \'%attentive%\' then \'Attentive\' when lower(GA_SOURCEMEDIUM) like \'%pushowl%\' then \'PushOwl\' when lower(GA_SOURCEMEDIUM) like any (\'%email%\',\'%klaviyo%\') then \'Email\' when lower(GA_SOURCEMEDIUM) like any (\'%affiliate%\',\'%affliate%\') then \'Affiliate\' when lower(GA_SOURCEMEDIUM) like \'%content%\' then \'Content\' when lower(GA_SOURCEMEDIUM) like \'%referral%\' then \'Referral\' when lower(GA_SOURCEMEDIUM) like \'%tiktok%\' then \'TikTok\' when lower(GA_SOURCEMEDIUM) like \'%sms%\' then \'SMS\' when lower(GA_SOURCEMEDIUM) like \'%telegram%\' then \'Telegram\' when lower(GA_SOURCEMEDIUM) like \'%twitter%\' then \'Twitter\' when lower(GA_SOURCEMEDIUM) like \'%pinterest%\' then \'Pinterest\' when lower(GA_SOURCEMEDIUM) like \'%linkedin%\' then \'LinkedIn\' else \'Others\' end as Final_Channel ,coalesce(GADSC.\"campaign.advertising_channel_type\",MC.AD_NETWORK_TYPE) CAMPAIGN_TYPE from VAHDAM_DB.MAPLEMONK.GA_IN_WEBSITE_SESSIONS_BY_DATE_CAMPAIGN_SOURCE GASE left join (select * from (select *, row_number() over (partition by \"campaign.name\" order by \"segments.date\" desc) rw from VAHDAM_DB.MAPLEMONK.gads_in_campaign_data) where rw=1) GADSC on lower(GADSC.\"campaign.name\") = lower(GASE.ga_campaign) left join (select * from (select *, row_number() over (partition by campaign_name order by date desc) rw from Vahdam_db.maplemonk.marketing_consolidated_in) where rw=1) MC on lower(GASE.ga_campaign) = lower(MC.campaign_name) Union all select \'Shopify_Italy\' as Region ,ga_date ,view_id ,ga_exits ,ga_users ,ga_campaign ,ga_newusers ,ga_sessions ,ga_pageviews ,ga_sourcemedium ,ga_uniquepageviews ,ga_avgsessionduration ,case when lower(GA_SOURCEMEDIUM) like any (\'%facebook%\',\'%fb%\') then \'Facebook\' when lower(GA_SOURCEMEDIUM) like any (\'%instagram%\',\'%igshopping%\',\'%insta%\',\'%ig%\') then \'Instagram\' when lower(GA_SOURCEMEDIUM) like any (\'%google%\',\'%youtube%\',\'%yt%\') then \'Google\' when lower(GA_SOURCEMEDIUM) like \'%duckduckgo%\' then \'Duckduckgo\' when lower(GA_SOURCEMEDIUM) like \'%bing%\' then \'Bing\' when lower(GA_SOURCEMEDIUM) like \'%yahoo%\' then \'Yahoo\' when lower(GA_SOURCEMEDIUM) like \'%direct%\' then \'Direct\' when lower(GA_SOURCEMEDIUM) like \'%attentive%\' then \'Attentive\' when lower(GA_SOURCEMEDIUM) like \'%pushowl%\' then \'PushOwl\' when lower(GA_SOURCEMEDIUM) like any (\'%email%\',\'%klaviyo%\') then \'Email\' when lower(GA_SOURCEMEDIUM) like any (\'%affiliate%\',\'%affliate%\') then \'Affiliate\' when lower(GA_SOURCEMEDIUM) like \'%content%\' then \'Content\' when lower(GA_SOURCEMEDIUM) like \'%referral%\' then \'Referral\' when lower(GA_SOURCEMEDIUM) like \'%tiktok%\' then \'TikTok\' when lower(GA_SOURCEMEDIUM) like \'%sms%\' then \'SMS\' when lower(GA_SOURCEMEDIUM) like \'%telegram%\' then \'Telegram\' when lower(GA_SOURCEMEDIUM) like \'%twitter%\' then \'Twitter\' when lower(GA_SOURCEMEDIUM) like \'%pinterest%\' then \'Pinterest\' when lower(GA_SOURCEMEDIUM) like \'%linkedin%\' then \'LinkedIn\' else \'Others\' end as Final_Channel ,Null as CAMPAIGN_TYPE from VAHDAM_DB.MAPLEMONK.GA_IT_WEBSITE_SESSIONS_BY_DATE_CAMPAIGN_SOURCE GASE;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from VAHDAM_DB.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        