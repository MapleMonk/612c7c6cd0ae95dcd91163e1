{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "create or replace table avorganics_db.maplemonk.quickcommerce_primarysales_fact_items as select null as CUSTOMER_ID_FINAL, null as acquisition_date, null as FIRST_COMPLETE_ORDER_DATE, null as MAPLE_MONK_ID_PHONE, null as CUSTOMER_ID, case when channel = \'Blink It\' then \'Blinkit\' when channel = \'Big Basket\' then \'Bigbasket\' else channel end as shop_name, case when channel = \'Blink It\' then \'Blinkit\' when channel = \'Big Basket\' then \'Bigbasket\' else channel end as marketplace, case when channel = \'Blink It\' then \'Blinkit\' when channel = \'Big Basket\' then \'Bigbasket\' else channel end as channel, case when channel = \'Blink It\' then \'Blinkit\' when channel = \'Big Basket\' then \'Bigbasket\' else channel end as source, po ordeR_id, po reference_code, null as phone, buyer as name, null as email, null as SHIPPING_LAST_UPDATE_DATE, b.primarykey sku, b.primarykey product_id, a.\"PRODUCT\" product_name, null as currency, null as city, state as state, null as order_status, to_date(date,\'mm/dd/yyyy\') ordeR_date, \"SEND QTY\"::float quantity, null as gross_sales_before_tax, null as discount, null as tax, replace(\"Total (INR)\",\',\',\'\')::float shipping_price, replace(\"Total (INR)\",\',\',\'\')::float selling_price, null as OMS_ORDER_STATUS, null as shipping_Status, null as final_shipping_status, null as SALEORDERITEMCODE, null as SALES_ORDER_ITEM_ID, null as AWB, null as PAYMENT_GATEWAY, null as PAYMENT_MODE, null as COURIER, null as DISPATCH_DATE, to_date(date,\'mm/dd/yyyy\') DELIVERED_DATE, to_date(date,\'mm/dd/yyyy\') DELIVERED_STATUS, null as RETURN_FLAG ,null as RETURNED_QUANTITY ,null as RETURNED_SALES ,null as CANCELLED_QUANTITY ,null as DAYS_IN_SHIPMENT ,null as ACQUSITION_DATE ,b.primarykey SKU_CODE ,c.product_name as PRODUCT_NAME_FINAL ,c.category as PRODUCT_CATEGORY ,c.sub_Category as PRODUCT_SUB_CATEGORY ,null as WAREHOUSE ,null as NEW_CUSTOMER_FLAG ,null as NEW_CUSTOMER_FLAG_MONTH ,null as ACQUISITION_PRODUCT ,null as ACQUISITION_CHANNEL ,null as ACQUISITION_MARKETPLACE ,\'Primary\' as sales_type from avorganics_db.maplemonk.quickcommerce_primary_sales a left join (select distinct * from avorganics_db.maplemonk.quickcom_primarysales_product_mapping) b on b.\"PRODUCT\" = a.\"PRODUCT\" left join (select sku, product_name, category, sub_category from (select primarykey sku, \"PRODUCT TITLE\" product_name, category, sub_category, row_number() over (partition by primarykey order by 1) rw from avorganics_db.maplemonk.sku_master )where rw = 1) c on b.primarykey = c.sku ; create or replace table avorganics_db.maplemonk.quickcommerce_sales_consolidated as select * from avorganics_db.maplemonk.quickcommerce_primarysales_fact_items union all select *, \'Secondary\' as sales_type from avorganics_db.maplemonk.zepto_fact_items union all select *, \'Secondary\' as sales_type from avorganics_db.maplemonk.swiggy_fact_items union all select *, \'Secondary\' as sales_type from avorganics_db.maplemonk.blinkit_fact_items ;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from avorganics_db.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        