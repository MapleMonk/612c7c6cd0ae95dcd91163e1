{{ config(
            materialized='table',
                post_hook={
                    "sql": "create or replace table maplemonk.zouk_AA_SB_CONSOLIDATED_HOURLY_DATA as with SB_TRAFFIC_HOURLY as (select ADVERTISER_ID ,MARKETPLACE_ID ,profileId ,DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\') Date ,EXTRACT(HOUR FROM DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\')) Hour ,AD_ID ,KEYWORD_ID ,AD_GROUP_ID ,CAMPAIGN_ID ,KEYWORD_TEXT ,KEYWORD_TYPE ,PLACEMENT_TYPE ,CURRENCY ,sum(safe_cast(COST as FLOAT64)) SPEND ,sum(safe_cast(IMPRESSIONS as FLOAT64)) IMPRESSIONS ,sum(safe_cast(CLICKS as FLOAT64)) CLICKS ,sum(safe_cast(VIEWABLE_IMPRESSIONS as FLOAT64)) VIEWABLE_IMPRESSIONS from maplemonk.zouk_ams_sb_traffic group by 1,2,3,4,5,6,7,8,9,10,11,12,13) , SB_CONVERSIONS_HOURLY as ( select ADVERTISER_ID ,MARKETPLACE_ID ,profileId ,DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\') Date ,EXTRACT(HOUR FROM DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\')) Hour ,AD_ID ,KEYWORD_ID ,AD_GROUP_ID ,CAMPAIGN_ID ,KEYWORD_TEXT ,KEYWORD_TYPE ,PLACEMENT_TYPE ,CURRENCY ,sum(safe_cast(ATTRIBUTED_SALES_14D as FLOAT64)) ATTRIBUTED_SALES_14D ,sum(safe_cast(ATTRIBUTED_UNITS_ORDERED_14D as FLOAT64)) ATTRIBUTED_UNITS_ORDERED_14D ,sum(safe_cast(ATTRIBUTED_CONVERSIONS_14D as FLOAT64)) ATTRIBUTED_CONVERSIONS_14D ,sum(safe_cast(VIEW_ATTRIBUTED_SALES_14D as FLOAT64)) VIEW_ATTRIBUTED_SALES_14D ,sum(safe_cast(VIEW_ATTRIBUTED_UNITS_ORDERED_14D as FLOAT64)) VIEW_ATTRIBUTED_UNITS_ORDERED_14D ,sum(safe_cast(VIEW_ATTRIBUTED_CONVERSIONS_14D as FLOAT64)) VIEW_ATTRIBUTED_CONVERSIONS_14D ,sum(safe_cast(ATTRIBUTED_SALES_14D_SAME_SKU as FLOAT64)) ATTRIBUTED_SALES_14D_SAME_SKU ,sum(safe_cast(ATTRIBUTED_CONVERSIONS_14D_SAME_SKU as FLOAT64)) ATTRIBUTED_CONVERSIONS_14D_SAME_SKU ,sum(safe_cast(ATTRIBUTED_SALES_NEW_TO_BRAND_14D as FLOAT64)) ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,sum(safe_cast(ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D as FLOAT64)) ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,sum(safe_cast(ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D as FLOAT64)) ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,sum(safe_cast(VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D as FLOAT64)) VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,sum(safe_cast(VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D as FLOAT64)) VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,sum(safe_cast(VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D as FLOAT64)) VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D from maplemonk.zouk_ams_sb_conversion group by 1,2,3,4,5,6,7,8,9,10,11,12,13 ) select coalesce(a.ADVERTISER_ID, b.ADVERTISER_ID) ADVERTISER_ID ,coalesce(a.MARKETPLACE_ID, b.MARKETPLACE_ID) MARKETPLACE_ID ,coalesce(a.profileid, b.profileid) PROFILEID ,coalesce(a.Date, b.Date) Date ,coalesce(a.Hour, b.Hour) Hour ,coalesce(a.AD_ID, b.AD_ID) AD_ID ,coalesce(a.KEYWORD_ID, b.KEYWORD_ID) KEYWORD_ID ,coalesce(a.AD_GROUP_ID, b.AD_GROUP_ID) AD_GROUP_ID ,coalesce(a.CAMPAIGN_ID, b.CAMPAIGN_ID) CAMPAIGN_ID ,coalesce(a.KEYWORD_TEXT, b.KEYWORD_TEXT) KEYWORD_TEXT ,coalesce(a.KEYWORD_TYPE, b.KEYWORD_TYPE) KEYWORD_TYPE ,coalesce(a.PLACEMENT_TYPE, b.PLACEMENT_TYPE) PLACEMENT_TYPE ,coalesce(a.CURRENCY, b.CURRENCY) CURRENCY ,b.ATTRIBUTED_SALES_14D ,b.ATTRIBUTED_UNITS_ORDERED_14D ,b.ATTRIBUTED_CONVERSIONS_14D ,b.VIEW_ATTRIBUTED_SALES_14D ,b.VIEW_ATTRIBUTED_UNITS_ORDERED_14D ,b.VIEW_ATTRIBUTED_CONVERSIONS_14D ,b.ATTRIBUTED_SALES_14D_SAME_SKU ,b.ATTRIBUTED_CONVERSIONS_14D_SAME_SKU ,b.ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,b.ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,b.ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,b.VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,b.VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,b.VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,a.SPEND ,a.IMPRESSIONS ,a.CLICKS ,a.VIEWABLE_IMPRESSIONS from SB_TRAFFIC_HOURLY a full outer join SB_CONVERSIONS_HOURLY b on a.MARKETPLACE_ID = b.MARKETPLACE_ID and a.Date = b.Date and a.AD_ID = b.AD_ID and a.KEYWORD_ID = b.KEYWORD_ID and a.AD_GROUP_ID = b.AD_GROUP_ID and a.CAMPAIGN_ID = b.CAMPAIGN_ID and lower(a.PLACEMENT_TYPE) = lower(b.PLACEMENT_TYPE) and a.profileid = b.profileid; create or replace table maplemonk.zouk_AA_SD_CONSOLIDATED_HOURLY_DATA as with SD_TRAFFIC_HOURLY as (select ADVERTISER_ID ,MARKETPLACE_ID ,profileId ,DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\') Date ,EXTRACT(HOUR FROM DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\')) Hour ,AD_ID ,TARGET_ID ,AD_GROUP_ID ,CAMPAIGN_ID ,TARGETING_TEXT ,CURRENCY ,sum(safe_cast(COST as FLOAT64)) SPEND ,sum(safe_cast(IMPRESSIONS as FLOAT64)) IMPRESSIONS ,sum(safe_cast(CLICKS as FLOAT64)) CLICKS ,sum(safe_cast(VIEW_IMPRESSIONS as FLOAT64)) VIEWABLE_IMPRESSIONS from maplemonk.zouk_ams_sd_traffic group by 1,2,3,4,5,6,7,8,9,10,11), SD_CONVERSIONS_HOURLY as ( select ADVERTISER_ID ,MARKETPLACE_ID ,profileId ,DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\') Date ,EXTRACT(HOUR FROM DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\')) Hour ,AD_ID ,TARGET_ID ,AD_GROUP_ID ,CAMPAIGN_ID ,CURRENCY ,sum(safe_cast(ATTRIBUTED_SALES_14D as FLOAT64)) ATTRIBUTED_SALES_14D ,sum(safe_cast(ATTRIBUTED_UNITS_ORDERED_14D as FLOAT64)) ATTRIBUTED_UNITS_ORDERED_14D ,sum(safe_cast(ATTRIBUTED_CONVERSIONS_14D as FLOAT64)) ATTRIBUTED_CONVERSIONS_14D ,sum(safe_cast(VIEW_ATTRIBUTED_SALES_14D as FLOAT64)) VIEW_ATTRIBUTED_SALES_14D ,sum(safe_cast(VIEW_ATTRIBUTED_UNITS_ORDERED_14D as FLOAT64)) VIEW_ATTRIBUTED_UNITS_ORDERED_14D ,sum(safe_cast(VIEW_ATTRIBUTED_CONVERSIONS_14D as FLOAT64)) VIEW_ATTRIBUTED_CONVERSIONS_14D ,sum(safe_cast(ATTRIBUTED_SALES_14D_SAME_SKU as FLOAT64)) ATTRIBUTED_SALES_14D_SAME_SKU ,sum(safe_cast(ATTRIBUTED_CONVERSIONS_14D_SAME_SKU as FLOAT64)) ATTRIBUTED_CONVERSIONS_14D_SAME_SKU ,sum(safe_cast(ATTRIBUTED_SALES_NEW_TO_BRAND_14D as FLOAT64)) ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,sum(safe_cast(ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D as FLOAT64)) ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,sum(safe_cast(ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D as FLOAT64)) ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,sum(safe_cast(VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D as FLOAT64)) VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,sum(safe_cast(VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D as FLOAT64)) VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,sum(safe_cast(VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D as FLOAT64)) VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D from maplemonk.zouk_ams_sd_conversion group by 1,2,3,4,5,6,7,8,9,10 ) select coalesce(a.ADVERTISER_ID, b.ADVERTISER_ID) ADVERTISER_ID ,coalesce(a.MARKETPLACE_ID, b.MARKETPLACE_ID) MARKETPLACE_ID ,coalesce(a.PROFILEID, b.PROFILEID) PROFILEID ,coalesce(a.Date, b.Date) Date ,coalesce(a.Hour, b.Hour) Hour ,coalesce(a.AD_ID, b.AD_ID) AD_ID ,coalesce(a.TARGET_ID, b.TARGET_ID) TARGET_ID ,coalesce(a.AD_GROUP_ID, b.AD_GROUP_ID) AD_GROUP_ID ,coalesce(a.CAMPAIGN_ID, b.CAMPAIGN_ID) CAMPAIGN_ID ,a.TARGETING_TEXT ,coalesce(a.CURRENCY, b.CURRENCY) CURRENCY ,b.ATTRIBUTED_SALES_14D ,b.ATTRIBUTED_UNITS_ORDERED_14D ,b.ATTRIBUTED_CONVERSIONS_14D ,b.VIEW_ATTRIBUTED_SALES_14D ,b.VIEW_ATTRIBUTED_UNITS_ORDERED_14D ,b.VIEW_ATTRIBUTED_CONVERSIONS_14D ,b.ATTRIBUTED_SALES_14D_SAME_SKU ,b.ATTRIBUTED_CONVERSIONS_14D_SAME_SKU ,b.ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,b.ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,b.ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,b.VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,b.VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,b.VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,a.SPEND ,a.IMPRESSIONS ,a.CLICKS ,a.VIEWABLE_IMPRESSIONS from SD_TRAFFIC_HOURLY a full outer join SD_CONVERSIONS_HOURLY b on a.MARKETPLACE_ID = b.MARKETPLACE_ID and a.Date = b.Date and a.AD_ID = b.AD_ID and a.TARGET_ID = b.TARGET_ID and a.AD_GROUP_ID = b.AD_GROUP_ID and a.CAMPAIGN_ID = b.CAMPAIGN_ID and a.profileid = b.profileid ; create or replace table maplemonk.zouk_AA_SP_CONSOLIDATED_HOURLY_DATA as with SP_TRAFFIC_HOURLY as (select ADVERTISER_ID ,MARKETPLACE_ID ,profileid ,DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\') Date ,EXTRACT(HOUR FROM DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\')) Hour ,AD_ID ,KEYWORD_ID ,AD_GROUP_ID ,CAMPAIGN_ID ,KEYWORD_TEXT ,MATCH_TYPE ,PLACEMENT ,CURRENCY ,sum(safe_cast(COST as FLOAT64)) SPEND ,sum(safe_cast(IMPRESSIONS as FLOAT64)) IMPRESSIONS ,sum(safe_cast(CLICKS as FLOAT64)) CLICKS from maplemonk.zouk_ams_sp_traffic group by 1,2,3,4,5,6,7,8,9,10,11,12,13) , SP_CONVERSIONS_HOURLY as ( select ADVERTISER_ID ,MARKETPLACE_ID ,profileid ,DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\') Date ,EXTRACT(HOUR FROM DATETIME(TIMESTAMP(PARSE_TIMESTAMP(\'%Y-%m-%dT%H:%M:%S%Ez\', time_window_start)), \'Asia/Kolkata\')) Hour ,AD_ID ,KEYWORD_ID ,AD_GROUP_ID ,CAMPAIGN_ID ,PLACEMENT ,CURRENCY ,sum(safe_cast(ATTRIBUTED_SALES_14D as FLOAT64)) ATTRIBUTED_SALES_14D ,sum(safe_cast(ATTRIBUTED_UNITS_ORDERED_14D as FLOAT64)) ATTRIBUTED_UNITS_ORDERED_14D ,sum(safe_cast(ATTRIBUTED_CONVERSIONS_14D as FLOAT64)) ATTRIBUTED_CONVERSIONS_14D ,sum(safe_cast(ATTRIBUTED_SALES_14D_SAME_SKU as FLOAT64)) ATTRIBUTED_SALES_14D_SAME_SKU ,sum(safe_cast(ATTRIBUTED_CONVERSIONS_14D_SAME_SKU as FLOAT64)) ATTRIBUTED_CONVERSIONS_14D_SAME_SKU from maplemonk.zouk_ams_sp_conversion group by 1,2,3,4,5,6,7,8,9,10,11 ) select coalesce(a.ADVERTISER_ID, b.ADVERTISER_ID) ADVERTISER_ID ,coalesce(a.MARKETPLACE_ID, b.MARKETPLACE_ID) MARKETPLACE_ID ,coalesce(a.profileid, b.profileid) PROFILEID ,coalesce(a.Date, b.Date) Date ,coalesce(a.Hour, b.Hour) Hour ,coalesce(a.AD_ID, b.AD_ID) AD_ID ,coalesce(a.KEYWORD_ID, b.KEYWORD_ID) KEYWORD_ID ,coalesce(a.AD_GROUP_ID, b.AD_GROUP_ID) AD_GROUP_ID ,coalesce(a.CAMPAIGN_ID, b.CAMPAIGN_ID) CAMPAIGN_ID ,a.KEYWORD_TEXT ,a.MATCH_TYPE ,a.PLACEMENT ,coalesce(a.CURRENCY, b.CURRENCY) CURRENCY ,b.ATTRIBUTED_SALES_14D ,b.ATTRIBUTED_UNITS_ORDERED_14D ,b.ATTRIBUTED_CONVERSIONS_14D ,b.ATTRIBUTED_SALES_14D_SAME_SKU ,b.ATTRIBUTED_CONVERSIONS_14D_SAME_SKU ,a.SPEND ,a.IMPRESSIONS ,a.CLICKS from SP_TRAFFIC_HOURLY a full outer join SP_CONVERSIONS_HOURLY b on a.MARKETPLACE_ID = b.MARKETPLACE_ID and a.Date = b.Date and a.AD_ID = b.AD_ID and a.KEYWORD_ID = b.KEYWORD_ID and a.AD_GROUP_ID = b.AD_GROUP_ID and a.CAMPAIGN_ID = b.CAMPAIGN_ID and lower(a.PLACEMENT) = lower(b.PLACEMENT) and a.profileid = b.profileid ; CREATE OR REPLACE TABLE maplemonk.zouk_AMAZON_ADS_HOURLY_DATA_CONSOLIDATED AS select o.*, cd.campaignname , adg.adgroupname , add.adname as ASIN , td.targeting_type , td.targeting_value, pd.profileName, PD.SELLERID, pd.ACCOUNTYPE from ( select ADVERTISER_ID ,MARKETPLACE_ID ,PROFILEID ,Date ,Hour ,\'SPONSORED BRANDS\' AD_TYPE_1 ,AD_ID ,KEYWORD_ID ,AD_GROUP_ID ,CAMPAIGN_ID ,null as target_id ,KEYWORD_TEXT ,KEYWORD_TYPE ,null as TARGETING_TEXT ,PLACEMENT_TYPE ,CURRENCY ,ATTRIBUTED_SALES_14D ,ATTRIBUTED_UNITS_ORDERED_14D ,ATTRIBUTED_CONVERSIONS_14D ,VIEW_ATTRIBUTED_SALES_14D ,VIEW_ATTRIBUTED_UNITS_ORDERED_14D ,VIEW_ATTRIBUTED_CONVERSIONS_14D ,ATTRIBUTED_SALES_14D_SAME_SKU ,ATTRIBUTED_CONVERSIONS_14D_SAME_SKU ,ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,SPEND ,IMPRESSIONS ,CLICKS ,VIEWABLE_IMPRESSIONS from maplemonk.zouk_AA_SB_CONSOLIDATED_HOURLY_DATA union all select ADVERTISER_ID ,MARKETPLACE_ID ,PROFILEID ,Date ,Hour ,\'SPONSORED DISPLAY\' AD_TYPE_1 ,AD_ID ,null as keyword_id ,AD_GROUP_ID ,CAMPAIGN_ID ,TARGET_ID ,null as keyword_text ,null as KEYWORD_TYPE ,TARGETING_TEXT ,null as PLACEMENT_TYPE ,CURRENCY ,ATTRIBUTED_SALES_14D ,ATTRIBUTED_UNITS_ORDERED_14D ,ATTRIBUTED_CONVERSIONS_14D ,VIEW_ATTRIBUTED_SALES_14D ,VIEW_ATTRIBUTED_UNITS_ORDERED_14D ,VIEW_ATTRIBUTED_CONVERSIONS_14D ,ATTRIBUTED_SALES_14D_SAME_SKU ,ATTRIBUTED_CONVERSIONS_14D_SAME_SKU ,ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,SPEND ,IMPRESSIONS ,CLICKS ,VIEWABLE_IMPRESSIONS from maplemonk.zouk_AA_SD_CONSOLIDATED_HOURLY_DATA union all select ADVERTISER_ID ,MARKETPLACE_ID ,PROFILEID ,Date ,Hour ,\'SPONSORED PRODUCT\' AD_TYPE_1 ,AD_ID ,KEYWORD_ID ,AD_GROUP_ID ,CAMPAIGN_ID ,null as target_id ,KEYWORD_TEXT ,MATCH_TYPE ,null as target_text ,PLACEMENT ,CURRENCY ,ATTRIBUTED_SALES_14D ,ATTRIBUTED_UNITS_ORDERED_14D ,ATTRIBUTED_CONVERSIONS_14D ,null as VIEW_ATTRIBUTED_SALES_14D ,null as VIEW_ATTRIBUTED_UNITS_ORDERED_14D ,null as VIEW_ATTRIBUTED_CONVERSIONS_14D ,ATTRIBUTED_SALES_14D_SAME_SKU ,ATTRIBUTED_CONVERSIONS_14D_SAME_SKU ,null as ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,null as ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,null as ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,null as VIEW_ATTRIBUTED_SALES_NEW_TO_BRAND_14D ,null as VIEW_ATTRIBUTED_UNITS_ORDERED_NEW_TO_BRAND_14D ,null as VIEW_ATTRIBUTED_ORDERS_NEW_TO_BRAND_14D ,SPEND ,IMPRESSIONS ,CLICKS ,null as VIEWABLE_IMPRESSIONS from maplemonk.zouk_AA_SP_CONSOLIDATED_HOURLY_DATA )as o left join maplemonk.zouk_amazon_ads_campaign_details cd on o.campaign_id = cd.campaignid left join maplemonk.zouk_amazon_ads_adgroup_details adg on o.campaign_id = adg.campaignid and o.AD_GROUP_ID = adg.adgroupid left join maplemonk.zouk_amazon_ads_ad_details add on o.campaign_id = add.campaignid and o.AD_GROUP_ID = add.adgroupid and o.ad_id = add.adid left join maplemonk.zouk_amazon_ads_targeting_details td on o.campaign_id = td.campaignid and o.AD_GROUP_ID = td.adgroupid and o.target_id = td.targetid left join maplemonk.zouk_amazon_ads_keyword_details kd on o.campaign_id = kd.campaignid and o.AD_GROUP_ID = kd.adgroupid and o.keyword_id = kd.keywordid left join maplemonk.zouk_amazon_ads_profile_details pd on cast(o.profileid as string) = cast(pd.profileid as string) ;",
                    "transaction": true
                }
            ) }}
            with sample_data as (

                select * from maplemonk.INFORMATION_SCHEMA.TABLES
            ),
            
            final as (
                select * from sample_data
            )
            select * from final
            