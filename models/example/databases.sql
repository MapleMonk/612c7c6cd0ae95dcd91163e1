{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "CREATE OR REPLACE TABLE MM_TEST.NaveenSept7.MM_TEST_CUSTOMER_RETENTION AS SELECT year(Acquisition_Date) Acquisition_Year, monthname(Acquisition_Date) Acquisition_Month, last_day(Acquisition_Date) Acquisition_Month_LastDate, Acquisition_Channel, Acquisition_Marketplace, Acquisition_Product, Shop_Name as Purchase_Marketplace, count(distinct customer_id_final) total_customers, count(distinct case when lower(Acquisition_Marketplace) like \'%shopify%\' then customer_id_final end) Shopify_Acquired_Customers, count(distinct case when lower(Acquisition_Marketplace) like \'%cred%\' then customer_id_final end) CRED_Acquired_Customers, count(distinct case when last_day(Acquisition_Date)=last_day(order_date) then order_id end) total_orders, sum(case when last_day(Acquisition_Date)=last_day(order_date) then selling_price end) total_sales, count(distinct case when last_day(Acquisition_Date)<>last_day(order_date) then customer_id_final end) mn_c, count(distinct case when last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) mn_c_Shopify, count(distinct case when last_day(Acquisition_Date)<>last_day(order_date) then order_id end) mn_o, count(distinct case when last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) mn_o_Shopify, sum(case when last_day(Acquisition_Date)<>last_day(order_date) then selling_price end) mn_s, sum(case when last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) mn_s_Shopify, count(distinct case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) then customer_id_final end) product_mn_c, count(distinct case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_mn_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) then order_id end) product_mn_o, count(distinct case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_mn_o_Shopify, sum(case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) then selling_price end) product_mn_s, sum(case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_mn_s_Shopify, count(distinct case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) then customer_id_final end) m2_c, count(distinct case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) then customer_id_final end) m3_c, count(distinct case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) then customer_id_final end) m4_c, count(distinct case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) then customer_id_final end) m5_c, count(distinct case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) then customer_id_final end) m6_c, count(distinct case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) then customer_id_final end) m7_c, count(distinct case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) then customer_id_final end) m8_c, count(distinct case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) then customer_id_final end) m9_c, count(distinct case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) then customer_id_final end) m10_c, count(distinct case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) then customer_id_final end) m11_c, count(distinct case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) then customer_id_final end) m12_c, count(distinct case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) then order_id end) m2_o, count(distinct case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) then order_id end) m3_o, count(distinct case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) then order_id end) m4_o, count(distinct case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) then order_id end) m5_o, count(distinct case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) then order_id end) m6_o, count(distinct case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) then order_id end) m7_o, count(distinct case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) then order_id end) m8_o, count(distinct case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) then order_id end) m9_o, count(distinct case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) then order_id end) m10_o, count(distinct case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) then order_id end) m11_o, count(distinct case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) then order_id end) m12_o, sum(case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) then selling_price end) m2_s, sum(case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) then selling_price end) m3_s, sum(case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) then selling_price end) m4_s, sum(case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) then selling_price end) m5_s, sum(case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) then selling_price end) m6_s, sum(case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) then selling_price end) m7_s, sum(case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) then selling_price end) m8_s, sum(case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) then selling_price end) m9_s, sum(case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) then selling_price end) m10_s, sum(case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) then selling_price end) m11_s, sum(case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) then selling_price end) m12_s, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m2_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m3_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m4_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m5_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m6_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m7_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m8_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m9_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m10_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m11_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m12_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))= last_day(order_date) then order_id end) product_m2_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))= last_day(order_date) then order_id end) product_m3_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))= last_day(order_date) then order_id end) product_m4_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))= last_day(order_date) then order_id end) product_m5_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))= last_day(order_date) then order_id end) product_m6_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))= last_day(order_date) then order_id end) product_m7_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))= last_day(order_date) then order_id end) product_m8_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))= last_day(order_date) then order_id end) product_m9_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))= last_day(order_date) then order_id end) product_m10_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))= last_day(order_date) then order_id end) product_m11_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))= last_day(order_date) then order_id end) product_m12_o, sum(case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) then selling_price end) product_m2_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) then selling_price end) product_m3_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) then selling_price end) product_m4_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) then selling_price end) product_m5_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) then selling_price end) product_m6_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) then selling_price end) product_m7_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) then selling_price end) product_m8_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) then selling_price end) product_m9_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) then selling_price end) product_m10_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) then selling_price end) product_m11_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) then selling_price end) product_m12_s, count(distinct case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m2_c_Shopify, count(distinct case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m3_c_Shopify, count(distinct case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m4_c_Shopify, count(distinct case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m5_c_Shopify, count(distinct case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m6_c_Shopify, count(distinct case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m7_c_Shopify, count(distinct case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m8_c_Shopify, count(distinct case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m9_c_Shopify, count(distinct case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m10_c_Shopify, count(distinct case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m11_c_Shopify, count(distinct case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m12_c_Shopify, count(distinct case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m2_o_Shopify, count(distinct case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m3_o_Shopify, count(distinct case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m4_o_Shopify, count(distinct case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m5_o_Shopify, count(distinct case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m6_o_Shopify, count(distinct case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m7_o_Shopify, count(distinct case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m8_o_Shopify, count(distinct case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m9_o_Shopify, count(distinct case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m10_o_Shopify, count(distinct case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m11_o_Shopify, count(distinct case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m12_o_Shopify, sum(case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m2_s_Shopify, sum(case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m3_s_Shopify, sum(case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m4_s_Shopify, sum(case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m5_s_Shopify, sum(case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m6_s_Shopify, sum(case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m7_s_Shopify, sum(case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m8_s_Shopify, sum(case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m9_s_Shopify, sum(case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m10_s_Shopify, sum(case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m11_s_Shopify, sum(case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m12_s_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m2_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m3_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m4_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m5_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m6_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m7_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m8_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m9_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m10_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m11_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m12_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m2_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m3_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m4_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m5_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m6_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m7_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m8_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m9_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m10_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m11_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m12_o_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m2_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m3_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m4_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m5_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m6_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m7_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m8_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m9_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m10_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m11_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m12_s_Shopify from ( select customer_id_final, order_id, acquisition_product, acquisition_channel, acquisition_marketplace, shop_name, product_name as product_name, order_date, selling_price, Acquisition_Date::date as Acquisition_Date from MM_TEST.NaveenSept7.MM_TEST_SALES_CONSOLIDATED where customer_id_final is not null and lower(order_status) <> \'cancelled\' )res group by year(Acquisition_Date), monthname(Acquisition_Date), last_day(Acquisition_Date), Acquisition_channel, acquisition_marketplace, Acquisition_Product, shop_name union all SELECT year(Acquisition_Date) Acquisition_Year, monthname(Acquisition_Date) Acquisition_Month, last_day(Acquisition_Date) Acquisition_Month_LastDate, Acquisition_Channel Marketing_channel, Acquisition_Marketplace, Acquisition_Product, \'All\' as Purchase_Marketplace, count(distinct customer_id_final) total_customers, count(distinct case when lower(Acquisition_Marketplace) like \'%shopify%\' then customer_id_final end) Shopify_Acquired_Customers, count(distinct case when lower(Acquisition_Marketplace) like \'%cred%\' then customer_id_final end) CRED_Acquired_Customers, count(distinct case when last_day(Acquisition_Date)=last_day(order_date) then order_id end) total_orders, sum(case when last_day(Acquisition_Date)=last_day(order_date) then selling_price end) total_sales, count(distinct case when last_day(Acquisition_Date)<>last_day(order_date) then customer_id_final end) mn_c, count(distinct case when last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) mn_c_Shopify, count(distinct case when last_day(Acquisition_Date)<>last_day(order_date) then order_id end) mn_o, count(distinct case when last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) mn_o_Shopify, sum(case when last_day(Acquisition_Date)<>last_day(order_date) then selling_price end) mn_s, sum(case when last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) mn_s_Shopify, count(distinct case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) then customer_id_final end) product_mn_c, count(distinct case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_mn_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) then order_id end) product_mn_o, count(distinct case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_mn_o_Shopify, sum(case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) then selling_price end) product_mn_s, sum(case when acquisition_product=product_name and last_day(Acquisition_Date)<>last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_mn_s_Shopify, count(distinct case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) then customer_id_final end) m2_c, count(distinct case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) then customer_id_final end) m3_c, count(distinct case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) then customer_id_final end) m4_c, count(distinct case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) then customer_id_final end) m5_c, count(distinct case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) then customer_id_final end) m6_c, count(distinct case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) then customer_id_final end) m7_c, count(distinct case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) then customer_id_final end) m8_c, count(distinct case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) then customer_id_final end) m9_c, count(distinct case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) then customer_id_final end) m10_c, count(distinct case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) then customer_id_final end) m11_c, count(distinct case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) then customer_id_final end) m12_c, count(distinct case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) then order_id end) m2_o, count(distinct case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) then order_id end) m3_o, count(distinct case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) then order_id end) m4_o, count(distinct case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) then order_id end) m5_o, count(distinct case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) then order_id end) m6_o, count(distinct case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) then order_id end) m7_o, count(distinct case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) then order_id end) m8_o, count(distinct case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) then order_id end) m9_o, count(distinct case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) then order_id end) m10_o, count(distinct case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) then order_id end) m11_o, count(distinct case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) then order_id end) m12_o, sum(case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) then selling_price end) m2_s, sum(case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) then selling_price end) m3_s, sum(case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) then selling_price end) m4_s, sum(case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) then selling_price end) m5_s, sum(case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) then selling_price end) m6_s, sum(case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) then selling_price end) m7_s, sum(case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) then selling_price end) m8_s, sum(case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) then selling_price end) m9_s, sum(case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) then selling_price end) m10_s, sum(case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) then selling_price end) m11_s, sum(case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) then selling_price end) m12_s, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m2_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m3_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m4_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m5_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m6_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m7_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m8_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m9_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m10_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m11_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))= last_day(order_date) then customer_id_final end) product_m12_c, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))= last_day(order_date) then order_id end) product_m2_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))= last_day(order_date) then order_id end) product_m3_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))= last_day(order_date) then order_id end) product_m4_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))= last_day(order_date) then order_id end) product_m5_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))= last_day(order_date) then order_id end) product_m6_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))= last_day(order_date) then order_id end) product_m7_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))= last_day(order_date) then order_id end) product_m8_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))= last_day(order_date) then order_id end) product_m9_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))= last_day(order_date) then order_id end) product_m10_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))= last_day(order_date) then order_id end) product_m11_o, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))= last_day(order_date) then order_id end) product_m12_o, sum(case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) then selling_price end) product_m2_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) then selling_price end) product_m3_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) then selling_price end) product_m4_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) then selling_price end) product_m5_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) then selling_price end) product_m6_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) then selling_price end) product_m7_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) then selling_price end) product_m8_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) then selling_price end) product_m9_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) then selling_price end) product_m10_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) then selling_price end) product_m11_s, sum(case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) then selling_price end) product_m12_s, count(distinct case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m2_c_Shopify, count(distinct case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m3_c_Shopify, count(distinct case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m4_c_Shopify, count(distinct case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m5_c_Shopify, count(distinct case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m6_c_Shopify, count(distinct case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m7_c_Shopify, count(distinct case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m8_c_Shopify, count(distinct case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m9_c_Shopify, count(distinct case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m10_c_Shopify, count(distinct case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m11_c_Shopify, count(distinct case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) m12_c_Shopify, count(distinct case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m2_o_Shopify, count(distinct case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m3_o_Shopify, count(distinct case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m4_o_Shopify, count(distinct case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m5_o_Shopify, count(distinct case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m6_o_Shopify, count(distinct case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m7_o_Shopify, count(distinct case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m8_o_Shopify, count(distinct case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m9_o_Shopify, count(distinct case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m10_o_Shopify, count(distinct case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m11_o_Shopify, count(distinct case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) m12_o_Shopify, sum(case when last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m2_s_Shopify, sum(case when last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m3_s_Shopify, sum(case when last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m4_s_Shopify, sum(case when last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m5_s_Shopify, sum(case when last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m6_s_Shopify, sum(case when last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m7_s_Shopify, sum(case when last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m8_s_Shopify, sum(case when last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m9_s_Shopify, sum(case when last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m10_s_Shopify, sum(case when last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m11_s_Shopify, sum(case when last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) m12_s_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m2_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m3_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m4_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m5_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m6_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m7_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m8_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m9_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m10_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m11_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then customer_id_final end) product_m12_c_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m2_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m3_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m4_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m5_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m6_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m7_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m8_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m9_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m10_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m11_o_Shopify, count(distinct case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))= last_day(order_date) and lower(shop_name) like \'%shopify%\' then order_id end) product_m12_o_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,1,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m2_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,2,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m3_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,3,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m4_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,4,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m5_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,5,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m6_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,6,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m7_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,7,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m8_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,8,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m9_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,9,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m10_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,10,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m11_s_Shopify, sum(case when acquisition_product=product_name and last_day(dateadd(month,11,Acquisition_Date))=last_day(order_date) and lower(shop_name) like \'%shopify%\' then selling_price end) product_m12_s_Shopify from ( select customer_id_final, order_id, acquisition_product, Acquisition_channel, acquisition_marketplace, shop_name, product_name as product_name, order_date, selling_price, Acquisition_Date::date as Acquisition_Date from MM_TEST.NaveenSept7.MM_TEST_SALES_CONSOLIDATED where customer_id_final is not null and lower(order_status) <> \'cancelled\' )res group by year(Acquisition_Date), monthname(Acquisition_Date), last_day(Acquisition_Date), Acquisition_channel, acquisition_marketplace, Acquisition_Product;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from MM_TEST.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        