{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "CREATE OR REPLACE TABLE SOLARA_DB.MAPLEMONK.FINAL_SKU_MASTER AS select * from (select * ,row_number() over (partition by MARKETPLACE_SKU order by 1) frw from ( select upper(skucode) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(skucode) skucode ,\'SHOPIFY\' MARKETPLACE from (select PRIMARYKEY skucode , \"PRODUCT TITLE\" name , category , sub_category , \"FLIPKART FSN\" Flipkart_FSN , ASIN AMAZON_ASIN , \"MYNTRA SID\" MYNTRA_SKU , \"NYKAA SKU CODE\" NYKAA_SKU , row_number() over (partition by PRIMARYKEY order by 1) rw from SOLARA_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and upper(skucode) not in (\'#N/A\', \'0\', \'NA\', \'NOT LISTED\') union select upper(Flipkart_FSN) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(skucode) skucode ,\'FLIPKART\' MARKETPLACE from (select PRIMARYKEY skucode , \"PRODUCT TITLE\" name , category , sub_category , \"FLIPKART FSN\" Flipkart_FSN , ASIN AMAZON_ASIN , \"MYNTRA SID\" MYNTRA_SKU , \"NYKAA SKU CODE\" NYKAA_SKU , row_number() over (partition by \"FLIPKART FSN\" order by 1) rw from SOLARA_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and upper(Flipkart_FSN) not in (\'#N/A\', \'0\', \'NA\', \'NOT LISTED\') union select upper(AMAZON_ASIN) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(skucode) skucode ,\'AMAZON\' MARKETPLACE from (select PRIMARYKEY skucode , \"PRODUCT TITLE\" name , category , sub_category , \"FLIPKART FSN\" Flipkart_FSN , ASIN AMAZON_ASIN , \"MYNTRA SID\" MYNTRA_SKU , \"NYKAA SKU CODE\" NYKAA_SKU , row_number() over (partition by ASIN order by 1) rw from SOLARA_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and upper(AMAZON_ASIN) not in (\'#N/A\', \'0\', \'NA\', \'NOT\', \'NOT LISTED\') union select upper(MYNTRA_SKU) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(skucode) skucode ,\'MYNTRA\' Marketplace from (select PRIMARYKEY skucode , \"PRODUCT TITLE\" name , category , sub_category , \"FLIPKART FSN\" Flipkart_FSN , ASIN AMAZON_ASIN , \"MYNTRA SID\" MYNTRA_SKU , \"NYKAA SKU CODE\" NYKAA_SKU , row_number() over (partition by \"MYNTRA SID\" order by 1) rw from SOLARA_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and upper(MYNTRA_SKU) not in (\'#N/A\', \'0\', \'NA\', \'NOT\', \'NOT LISTED\') union select upper(NYKAA_SKU) MARKETPLACE_SKU ,upper(name) NAME ,upper(category) CATEGORY ,upper(sub_category) SUB_CATEGORY ,upper(skucode) skucode ,\'NYKAA\' Marketplace from (select PRIMARYKEY skucode , \"PRODUCT TITLE\" name , category , sub_category , \"FLIPKART FSN\" Flipkart_FSN , ASIN AMAZON_ASIN , \"MYNTRA SID\" MYNTRA_SKU , \"NYKAA SKU CODE\" NYKAA_SKU , row_number() over (partition by \"NYKAA SKU CODE\" order by 1) rw from SOLARA_DB.MAPLEMONK.mapping_sku_master) where rw = 1 and upper(NYKAA_SKU) not in (\'#N/A\', \'0\', \'NA\', \'NOT\', \'NOT LISTED\') ) ) where frw = 1;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from SOLARA_DB.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        