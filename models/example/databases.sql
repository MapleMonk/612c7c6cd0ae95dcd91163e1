{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "CREATE OR REPLACE TABLE VAHDAM_DB.MAPLEMONK.ITALY_DSR AS WITH CTE AS (SELECT FI.ORDER_TIMESTAMP::date AS DATE, UPPER(DAYNAME(FI.ORDER_TIMESTAMP::DATE)) AS Day, SUM(CASE WHEN FI.shop_name=\'Shopify_Italy\' THEN FI.Net_Sales_INR END) AS Shopify_Italy_Sales, SUM(CASE WHEN FI.shop_name=\'Amazon_IT\' THEN FI.Net_Sales_INR END) AS Amazon_Italy_Sales FROM Vahdam_db.maplemonk.FACT_ITEMS FI WHERE FI.is_refund=0 GROUP BY FI.ORDER_TIMESTAMP::date ORDER BY FI.ORDER_TIMESTAMP::date DESC) SELECT CTE.*, AZ.AMAZON_ADS_IT_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_IT_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_IT_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_IT_SPEND_SPONSORED_BRANDS FROM CTE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_IT\' THEN SPEND_INR END) AS AMAZON_ADS_IT_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_IT\' THEN SPEND_INR END) AS AMAZON_ADS_IT_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_IT\' THEN SPEND_INR END) AS AMAZON_ADS_IT_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_IT\' THEN SPEND_INR END) AS AMAZON_ADS_IT_SPEND_SPONSORED_BRANDS FROM Vahdam_db.maplemonk.AMAZONADS_EU_MARKETING GROUP BY DATE) AZ ON CTE.DATE=AZ.DATE ORDER BY CTE.DATE DESC; CREATE OR REPLACE TABLE VAHDAM_DB.MAPLEMONK.Germany_DSR AS WITH CTE AS (SELECT FI.ORDER_TIMESTAMP::date AS DATE, UPPER(DAYNAME(FI.ORDER_TIMESTAMP::DATE)) AS Day, SUM(CASE WHEN FI.shop_name=\'Shopify_Germany\' THEN FI.Net_Sales_INR END) AS Shopify_Germany_Sales, SUM(CASE WHEN FI.shop_name=\'Amazon_DE\' THEN FI.Net_Sales_INR END) AS Amazon_Germany_Sales FROM Vahdam_db.maplemonk.FACT_ITEMS FI WHERE FI.is_refund=0 GROUP BY FI.ORDER_TIMESTAMP::date ORDER BY FI.ORDER_TIMESTAMP::date DESC) SELECT CTE.*, AZ.AMAZON_ADS_DE_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_DE_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_DE_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_DE_SPEND_SPONSORED_BRANDS FROM CTE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_DE\' THEN SPEND_INR END) AS AMAZON_ADS_DE_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_DE\' THEN SPEND_INR END) AS AMAZON_ADS_DE_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_DE\' THEN SPEND_INR END) AS AMAZON_ADS_DE_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_DE\' THEN SPEND_INR END) AS AMAZON_ADS_DE_SPEND_SPONSORED_BRANDS FROM Vahdam_db.maplemonk.AMAZONADS_EU_MARKETING GROUP BY DATE) AZ ON CTE.DATE=AZ.DATE ORDER BY CTE.DATE DESC; CREATE OR REPLACE TABLE VAHDAM_DB.MAPLEMONK.Global_DSR AS WITH CTE AS (SELECT FI.ORDER_TIMESTAMP::date AS DATE, UPPER(DAYNAME(FI.ORDER_TIMESTAMP::DATE)) AS Day, SUM(CASE WHEN FI.shop_name=\'Shopify_Global\' THEN FI.Net_Sales_INR END) AS Shopify_Global_Sales, SUM(CASE WHEN FI.shop_name=\'Amazon_UK\' THEN FI.Net_Sales_INR END) AS Amazon_UK_Sales, SUM(CASE WHEN FI.shop_name=\'Amazon_ESP\' THEN FI.Net_Sales_INR END) AS Amazon_Spain_Sales, SUM(CASE WHEN FI.shop_name=\'Amazon_FR\' THEN FI.Net_Sales_INR END) AS Amazon_France_Sales FROM Vahdam_db.maplemonk.FACT_ITEMS FI WHERE FI.is_refund=0 GROUP BY FI.ORDER_TIMESTAMP::date ORDER BY FI.ORDER_TIMESTAMP::date DESC) SELECT CTE.*, AZ.AMAZON_ADS_ESP_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_ESP_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_ESP_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_ESP_SPEND_SPONSORED_BRANDS, AZ.AMAZON_ADS_UK_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_UK_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_UK_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_UK_SPEND_SPONSORED_BRANDS, AZ.AMAZON_ADS_FR_SPEND_SPONSORED_PRODUCTS, AZ.AMAZON_ADS_FR_SPEND_SPONSORED_DISPLAY, AZ.AMAZON_ADS_FR_SPEND_SPONSORED_BRANDS_VIDEO, AZ.AMAZON_ADS_FR_SPEND_SPONSORED_BRANDS FROM CTE LEFT JOIN (SELECT DATE, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_ESP\' THEN SPEND_INR END) AS AMAZON_ADS_ESP_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_ESP\' THEN SPEND_INR END) AS AMAZON_ADS_ESP_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_ESP\' THEN SPEND_INR END) AS AMAZON_ADS_ESP_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_ESP\' THEN SPEND_INR END) AS AMAZON_ADS_ESP_SPEND_SPONSORED_BRANDS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_UK\' THEN SPEND_INR END) AS AMAZON_ADS_UK_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_UK\' THEN SPEND_INR END) AS AMAZON_ADS_UK_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_UK\' THEN SPEND_INR END) AS AMAZON_ADS_UK_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_UK\' THEN SPEND_INR END) AS AMAZON_ADS_UK_SPEND_SPONSORED_BRANDS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Products\' and ACCOUNT = \'Amazon_FR\' THEN SPEND_INR END) AS AMAZON_ADS_FR_SPEND_SPONSORED_PRODUCTS, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Display\' AND ACCOUNT = \'Amazon_FR\' THEN SPEND_INR END) AS AMAZON_ADS_FR_SPEND_SPONSORED_DISPLAY, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands Video\' AND ACCOUNT = \'Amazon_FR\' THEN SPEND_INR END) AS AMAZON_ADS_FR_SPEND_SPONSORED_BRANDS_VIDEO, SUM(CASE WHEN CAMPAIGN_TYPE=\'Sponsored Brands\' AND ACCOUNT = \'Amazon_FR\' THEN SPEND_INR END) AS AMAZON_ADS_FR_SPEND_SPONSORED_BRANDS FROM Vahdam_db.maplemonk.AMAZONADS_EU_MARKETING GROUP BY DATE) AZ ON CTE.DATE=AZ.DATE ORDER BY CTE.DATE DESC;",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from VAHDAM_DB.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        