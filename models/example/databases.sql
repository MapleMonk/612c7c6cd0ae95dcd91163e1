{{ config(
                        materialized='table',
                            post_hook={
                                "sql": "create or replace table snitch_db.maplemonk.tally_gst_returns_report_2024 as select _airbyte_data:\"Date\"::varchar \"Date\", _airbyte_data:\"Sale Order Number\"::varchar \"Sale Order Number\", _airbyte_data:\"Invoice number\"::varchar \"Invoice number\", _airbyte_data:\"Channel entry\"::varchar \"Channel entry\", _airbyte_data:\"Channel Ledger\"::varchar \"Channel Ledger\", _airbyte_data:\"Product Name\"::varchar \"Product Name\", _airbyte_data:\"Product SKU Code\"::varchar \"Product SKU Code\", _airbyte_data:\"Qty\"::varchar \"Qty\", _airbyte_data:\"Unit Price\"::varchar \"Unit Price\", _airbyte_data:\"Currency\"::varchar \"Currency\", _airbyte_data:\"conversion rate\"::varchar \"conversion rate\", _airbyte_data:\"Total\"::varchar \"Total\", _airbyte_data:\"Customer Name\"::varchar \"Customer Name\", _airbyte_data:\"Shipping Address Name\"::varchar \"Shipping Address Name\", _airbyte_data:\"Shipping Address Line 1\"::varchar \"Shipping Address Line 1\", _airbyte_data:\"Shipping Address Line 2\"::varchar \"Shipping Address Line 2\", _airbyte_data:\"Shipping Address City\"::varchar \"Shipping Address City\", _airbyte_data:\"Shipping Address State\"::varchar \"Shipping Address State\", _airbyte_data:\"Shipping Address Country\"::varchar \"Shipping Address Country\", _airbyte_data:\"Shipping Address Pincode\"::varchar \"Shipping Address Pincode\", _airbyte_data:\"Shipping Address Phone\"::varchar \"Shipping Address Phone\", _airbyte_data:\"Shipping Provider\"::varchar \"Shipping Provider\", _airbyte_data:\"AWB num\"::varchar \"AWB num\", _airbyte_data:\"Sales\"::varchar \"Sales\", _airbyte_data:\"Sales Ledger\"::varchar \"Sales Ledger\", _airbyte_data:\"CGST\"::varchar \"CGST\", _airbyte_data:\"CGST Rate\"::varchar \"CGST Rate\", _airbyte_data:\"SGST\"::varchar \"SGST\", _airbyte_data:\"SGST Rate\"::varchar \"SGST Rate\", _airbyte_data:\"IGST\"::varchar \"IGST\", _airbyte_data:\"IGST Rate\"::varchar \"IGST Rate\", _airbyte_data:\"UTGST\"::varchar \"UTGST\", _airbyte_data:\"UTGST Rate\"::varchar \"UTGST Rate\", _airbyte_data:\"CESS\"::varchar \"CESS\", _airbyte_data:\"CESS Rate\"::varchar \"CESS Rate\", _airbyte_data:\"Other charges\"::varchar \"Other charges\", _airbyte_data:\"Other charges Ledger\"::varchar \"Other charges Ledger\", _airbyte_data:\"Other charges1\"::varchar \"Other charges1\", _airbyte_data:\"Other charges Ledger1\"::varchar \"Other charges Ledger1\", _airbyte_data:\"Service tax\"::varchar \"Service tax\", _airbyte_data:\"ST Ledger\"::varchar \"ST Ledger\", _airbyte_data:\"Discount Ledger\"::varchar \"Discount Ledger\", _airbyte_data:\"Discount Amount\"::varchar \"Discount Amount\", _airbyte_data:\"IMEI\"::varchar \"IMEI\", _airbyte_data:\"Godown\"::varchar \"Godown\", _airbyte_data:\"Dispatch Date/Cancellation Date\"::varchar \"Dispatch Date/Cancellation Date\", _airbyte_data:\"Narration\"::varchar \"Narration\", _airbyte_data:\"Entity\"::varchar \"Entity\", _airbyte_data:\"Voucher Type Name \"::varchar \"Voucher Type Name \", _airbyte_data:\"TIN NO\"::varchar \"TIN NO\", _airbyte_data:\"Original Invoice Date \"::varchar \"Original Invoice Date \", _airbyte_data:\"Original Invoice No\"::varchar \"Original Invoice No\", _airbyte_data:\"Invoice Channel Created\"::varchar \"Invoice Channel Created\", _airbyte_data:\"Channel State\"::varchar \"Channel State\", _airbyte_data:\"Channel_Party GSTIN\"::varchar \"Channel_Party GSTIN\", _airbyte_data:\"Customer GSTIN\"::varchar \"Customer GSTIN\", _airbyte_data:\"Billing Party Code\"::varchar \"Billing Party Code\", _airbyte_data:\"Tax Verification\"::varchar \"Tax Verification\", _airbyte_data:\"GST Registration Type\"::varchar \"GST Registration Type\", _airbyte_data:\"RP Code\"::varchar \"RP Code\", _airbyte_data:\"HSN CODE\"::varchar \"HSN CODE\", _airbyte_data:\"GRN Unit price without tax\"::varchar \"GRN Unit price without tax\", _airbyte_data:\"GRN Unit price with tax\"::varchar \"GRN Unit price with tax\", _airbyte_data:\"MRP\"::varchar \"MRP\", _airbyte_data:\"Return Type\"::varchar \"Return Type\" from snitch_db.maplemonk._airbyte_raw_s3_tally_gst_returns ; create or replace table snitch_db.maplemonk.tally_gst_sales_report_2024 as select _airbyte_data:\"Channel Created Date\"::varchar \"Channel Created Date\", _airbyte_data:\"Sale Order Number\"::varchar \"Sale Order Number\", _airbyte_data:\"Invoice number\"::varchar \"Invoice number\", _airbyte_data:\"Channel entry\"::varchar \"Channel entry\", _airbyte_data:\"Channel Ledger\"::varchar \"Channel Ledger\", _airbyte_data:\"Product Name\"::varchar \"Product Name\", _airbyte_data:\"Product SKU Code\"::varchar \"Product SKU Code\", _airbyte_data:\"Qty\"::varchar \"Qty\", _airbyte_data:\"Unit Price\"::varchar \"Unit Price\", _airbyte_data:\"Currency\"::varchar \"Currency\", _airbyte_data:\"conversion rate\"::varchar \"conversion rate\", _airbyte_data:\"Total\"::varchar \"Total\", _airbyte_data:\"Customer Name\"::varchar \"Customer Name\", _airbyte_data:\"Shipping Address Name\"::varchar \"Shipping Address Name\", _airbyte_data:\"Shipping Address Line 1\"::varchar \"Shipping Address Line 1\", _airbyte_data:\"Shipping Address Line 2\"::varchar \"Shipping Address Line 2\", _airbyte_data:\"Shipping Address City\"::varchar \"Shipping Address City\", _airbyte_data:\"Shipping Address State\"::varchar \"Shipping Address State\", _airbyte_data:\"Shipping Address Country\"::varchar \"Shipping Address Country\", _airbyte_data:\"Shipping Address Pincode\"::varchar \"Shipping Address Pincode\", _airbyte_data:\"Shipping Address Phone\"::varchar \"Shipping Address Phone\", _airbyte_data:\"Shipping Provider\"::varchar \"Shipping Provider\", _airbyte_data:\"AWB num\"::varchar \"AWB num\", _airbyte_data:\"Sales\"::varchar \"Sales\", _airbyte_data:\"Sales Ledger\"::varchar \"Sales Ledger\", _airbyte_data:\"CGST\"::varchar \"CGST\", _airbyte_data:\"CGST Rate\"::varchar \"CGST Rate\", _airbyte_data:\"SGST\"::varchar \"SGST\", _airbyte_data:\"SGST Rate\"::varchar \"SGST Rate\", _airbyte_data:\"IGST\"::varchar \"IGST\", _airbyte_data:\"IGST Rate\"::varchar \"IGST Rate\", _airbyte_data:\"UTGST\"::varchar \"UTGST\", _airbyte_data:\"UTGST Rate\"::varchar \"UTGST Rate\", _airbyte_data:\"CESS\"::varchar \"CESS\", _airbyte_data:\"CESS Rate\"::varchar \"CESS Rate\", _airbyte_data:\"Other charges\"::varchar \"Other charges\", _airbyte_data:\"Other charges Ledger\"::varchar \"Other charges Ledger\", _airbyte_data:\"Other charges1\"::varchar \"Other charges1\", _airbyte_data:\"Other charges Ledger1\"::varchar \"Other charges Ledger1\", _airbyte_data:\"Service tax\"::varchar \"Service tax\", _airbyte_data:\"ST Ledger\"::varchar \"ST Ledger\", _airbyte_data:\"Discount Ledger\"::varchar \"Discount Ledger\", _airbyte_data:\"Discount Amount\"::varchar \"Discount Amount\", _airbyte_data:\"IMEI\"::varchar \"IMEI\", _airbyte_data:\"Godown\"::varchar \"Godown\", _airbyte_data:\"Dispatch Date/Cancellation Date\"::varchar \"Dispatch Date/Cancellation Date\", _airbyte_data:\"Narration\"::varchar \"Narration\", _airbyte_data:\"Entity\"::varchar \"Entity\", _airbyte_data:\"Voucher Type Name \"::varchar \"Voucher Type Name \", _airbyte_data:\"TIN NO\"::varchar \"TIN NO\", _airbyte_data:\"Original Invoice Date \"::varchar \"Original Invoice Date \", _airbyte_data:\"Original Sale No\"::varchar \"Original Sale No\", _airbyte_data:\"Channel Invoice Created\"::varchar \"Channel Invoice Created\", _airbyte_data:\"Channel State\"::varchar \"Channel State\", _airbyte_data:\"Customer GSTIN\"::varchar \"Customer GSTIN\", _airbyte_data:\"Channel_Party GSTIN\"::varchar \"Channel_Party GSTIN\", _airbyte_data:\"Billing Party Code\"::varchar \"Billing Party Code\", _airbyte_data:\"Tax Verification\"::varchar \"Tax Verification\", _airbyte_data:\"GST Registration Type\"::varchar \"GST Registration Type\", _airbyte_data:\"TCS Amount\"::varchar \"TCS Amount\", _airbyte_data:\"HSN CODE\"::varchar \"HSN CODE\", _airbyte_data:\"GRN Unit price without tax\"::varchar \"GRN Unit price without tax\", _airbyte_data:\"GRN Unit price with tax\"::varchar \"GRN Unit price with tax\", _airbyte_data:\"MRP\"::varchar \"MRP\", _airbyte_data:\"Payment Mode\"::varchar \"Payment Mode\", _airbyte_data:\"Tax On Other Charges\"::varchar \"Tax On Other Charges\", _airbyte_data:\"Tax On Other Charges1\"::varchar \"Tax On Other Charges1\", _airbyte_data:\"Tax On Other Charges2\"::varchar \"Tax On Other Charges2\", _airbyte_data:\"DiscountCode\"::varchar \"DiscountCode\" from snitch_db.maplemonk._airbyte_raw_s3_tally_gst_sales",
                                "transaction": true
                            }
                        ) }}
                        with sample_data as (

                            select * from snitch_db.information_schema.databases
                        ),
                        
                        final as (
                            select * from sample_data
                        )
                        select * from final
                        