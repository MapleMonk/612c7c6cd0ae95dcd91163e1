{{ config(
            materialized='table',
                post_hook={
                    "sql": "Create or replace table maplemonk.zouk_amazon_ads_campaign_details as select distinct CAMPAIGNID ,name as campaignname ,targetingtype ,cast(null as string) as costtype from maplemonk.zouk_aa_sponsored_product_campaigns_v3_mm union all select distinct campaignid ,name ,cast(null as string) as targetingtype ,cast(null as string) as costtype from maplemonk.zouk_aa_sponsored_brands_campaigns union all select distinct campaignid ,name ,cast(null as string) as targetingtype ,COSTTYPE from maplemonk.zouk_aa_sponsored_display_campaigns ; Create or replace table maplemonk.zouk_amazon_ads_adgroup_details as select distinct adgroupid ,upper(name) as adgroupname ,campaignid ,cast(null as string) as creativetype ,cast(null as string) as bidoptimization from maplemonk.zouk_aa_sponsored_brands_ad_groups union all select distinct adgroupid ,upper(name) as adgroupname ,campaignid ,cast(null as string) as creativetype ,cast(null as string) as bidoptimization from maplemonk.zouk_aa_sponsored_product_ad_groups union all select distinct adgroupid ,upper(name) as adgroupname ,campaignid ,creativetype ,upper(bidoptimization) as bidoptimization from maplemonk.zouk_aa_sponsored_display_ad_groups ; Create or replace table maplemonk.zouk_amazon_ads_ad_details as select distinct adid ,upper(name) as adname ,adgroupid ,campaignid ,cast(JSON_EXTRACT_SCALAR(landingpage, \'$.pageType\') as String) as landingpage from maplemonk.zouk_aa_sponsored_brands_ads_v4_mm union all select distinct adid ,upper(asin) as asin ,adgroupid ,campaignid ,\'PRODUCT\' landingpage from maplemonk.zouk_aa_sponsored_product_ads union all select distinct adid ,upper(asin) as asin ,adgroupid ,campaignid ,\'PRODUCT\' landingpage from maplemonk.zouk_aa_sponsored_display_product_ads ; Create or replace table maplemonk.zouk_amazon_ads_targeting_details as SELECT targetid, adgroupid, campaignid, STRING_AGG(targeting_type ORDER BY targeting_type ASC) AS targeting_type, STRING_AGG(targeting_value ORDER BY targeting_type ASC) AS targeting_value FROM ( SELECT targetid, adgroupid, campaignid, JSON_EXTRACT_SCALAR(t, \'$.type\') AS targeting_type, JSON_EXTRACT_SCALAR(t, \'$.value\') AS targeting_value FROM maplemonk.zouk_aa_sponsored_display_targetings, UNNEST(CAST(expression AS ARRAY<STRING>)) AS t ) GROUP BY 1,2,3 union all SELECT targetid, adgroupid, campaignid, STRING_AGG(targeting_type ORDER BY targeting_type ASC) AS targeting_type, STRING_AGG(targeting_value ORDER BY targeting_type ASC) AS targeting_value FROM ( SELECT targetid, adgroupid, campaignid, JSON_EXTRACT_SCALAR(t, \'$.type\') AS targeting_type, JSON_EXTRACT_SCALAR(t, \'$.value\') AS targeting_value FROM maplemonk.zouk_aa_sponsored_product_targetings_v3_mm, UNNEST(CAST(expression AS ARRAY<STRING>)) AS t ) GROUP BY 1,2,3 ; Create or replace table maplemonk.zouk_amazon_ads_keyword_details as select distinct keywordid ,upper(keywordtext) as keywordtext ,adgroupid ,campaignid ,upper(matchtype) matchtype from maplemonk.zouk_aa_sponsored_brands_keywords union all select distinct keywordid ,upper(keywordtext) as keywordtext ,adgroupid ,campaignid ,cast(null as string) matchtype from maplemonk.zouk_aa_sponsored_product_keywords ;",
                    "transaction": true
                }
            ) }}
            with sample_data as (

                select * from maplemonk.INFORMATION_SCHEMA.TABLES
            ),
            
            final as (
                select * from sample_data
            )
            select * from final
            